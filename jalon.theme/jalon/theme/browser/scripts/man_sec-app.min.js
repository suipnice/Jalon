function setSelectionForm(){function e(e){v.focus(),$("#js-selection_form span.label").fadeIn(300,e).fadeOut(300)}function t(){a.getElementsByTagName("p")[0].querySelector("span").textContent=p.length}function n(){d.getElementsByTagName("p")[0].querySelector("span").textContent=y}function o(){var e=f.options;for(y=0,i=0;i<f.length;i++)null===e[i].text.match(S)?e[i].className="hide":(e[i].className="",y++);n()}function s(){E&&(S=new RegExp(E,"gi"),o(),h.value="Filtrage\xa0: "+E,g.removeAttribute("disabled"))}function r(e){var t=[],n=e.length;if(0!==n){for(i=0;i<n;i++){var o=[];o.optSort=e.options[i].text.toUpperCase(),o.optText=e.options[i].text,o.optValue=e.options[i].value,t[i]=o}for(t.sort(function(e,t){return e.optSort>t.optSort?1:e.optSort<t.optSort?-1:0}),i=0;i<n;i++)e.options[i].value=t[i].optValue,e.options[i].text=t[i].optText}}function l(e,i){if(e.selectedIndex!==-1){var s=new Option(e.options[e.options.selectedIndex].text,e.options[e.options.selectedIndex].value);e.removeChild(e.options[e.options.selectedIndex]),i.options[i.length]=s,r(i),i===f?o():(y=f.length-f.getElementsByClassName("hide").length,n()),t()}}var u=document.getElementById("js-selection_form"),a=document.getElementById("js-selected_list"),d=document.getElementById("js-complete_list"),c=u.querySelector("button[type=submit]"),p=a.querySelector("select"),f=d.querySelector("select"),m=d.getElementsByClassName("panel")[0],v=m.querySelector("input:not(disabled)"),h=m.querySelector("input:disabled"),b=m.querySelector("ul > li:first-child > button"),g=m.querySelector("ul > li:last-child > button"),y=0,E="",S="";e(function(){for(v.focus(),v.value="",h.value="",i=0;i<p.length;i++)$('#js-complete_list select option[value="'+p.options[i].value+'"]').remove();y=f.length,t(),n(),r(p),r(f)}),y>=1e4&&$("#js-highNumberWarning").slideDown("slow"),f.addEventListener("click",function(){v.focus(),l(f,p)},!1),p.addEventListener("click",function(){e(function(){l(p,f)})},!1),v.addEventListener("keyup",function(e){E=v.value.trim(),E?b.removeAttribute("disabled"):b.setAttribute("disabled","disabled"),S?g.removeAttribute("disabled"):g.setAttribute("disabled","disabled")},!1),v.addEventListener("keypress",function(t){13===t.keyCode&&(t.preventDefault(),t.stopPropagation(),e(s))},!1),b.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),e(s)},!1),g.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),S="",v.value="",h.value="",g.setAttribute("disabled","disabled"),b.setAttribute("disabled","disabled"),e(function(){for(i=0;i<f.length;i++)f.options[i].className="";y=f.length,n()})},!1),u.addEventListener("submit",function(e){c.setAttribute("disabled","disabled");var t=p.length;if(t>0)for(var n=0;n<t;n++)p.options[n].selected=!0;e.returnValue=!0},!1)}function setFormOfferResp(){_setTokenParams(),Foundation.utils.S("#input-auteurs").tokenInput(ABSOLUTE_URL+"/recherchUtilisateurs",$.extend({},tokenParams,{queryParam:"rechercheEns",tokenLimit:1}))}function setFormOfferTeacher(){_setTokenParams(),Foundation.utils.S("#input-coauteurs").tokenInput(ABSOLUTE_URL+"/recherchUtilisateurs",$.extend({},tokenParams,{queryParam:"rechercheEns"}))}function setFormOfferStudent(){_setTokenParams(),Foundation.utils.S("#input-coauteurs").tokenInput(ABSOLUTE_URL+"/recherchUtilisateurs",$.extend({},tokenParams,{queryParam:"rechercheEtu"}))}function setFormUserEdition(){var e=Foundation.utils.S("#admin-user_edit-form"),t=Foundation.utils.S("#js-studentInfo");e.on("click",'input[name="TYPE_IND"]',function(e){"Etudiant"===$(this).val()?t.is(":hidden")&&t.slideDown():t.is(":visible")&&t.slideUp(400,function(){$(this).find('input[type="text"]').val("")})})}