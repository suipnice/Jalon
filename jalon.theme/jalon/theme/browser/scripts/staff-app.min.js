function setBatchSelect(t,e){function n(t){t?(o.removeClass("inactive"),switchButtonEnabledState(a.find('.formControls > [type="submit"]'),!0)):(o.addClass("inactive"),switchButtonEnabledState(a.find('.formControls > [type="submit"]'),!1))}var a=Foundation.utils.S("#"+t),i=a.find("thead"),s=a.find("tbody"),o=a.find("tfoot a.dropdown"),l=a.find("thead .checkall input[type=checkbox]").attr("role"),u=i.find('.checkall input[role="'+l+'"]'),r=s.find('input[name="'+l+'"]'),d=("js-createAnnounce"===t||"js-mod-annonce"===t)&&Foundation.utils.S("#mailAnnounce"),c="undefined"==typeof e||!e;if(c)r.prop("checked",!1),u.prop("checked",!1),o.on("click",function(t){$(this).hasClass("inactive")&&(t.preventDefault(),t.stopPropagation())});else if(d){var p=s.find("input[type=checkbox]:checked").length;r.length===p?(u.prop("indeterminate",!1).prop("checked",!0),d.prop("disabled",!1)):p?(u.prop("indeterminate",!0).prop("checked",!1),d.prop("disabled",!1)):(u.prop("indeterminate",!1).prop("checked",!1),d.prop("disabled",!0))}else r.length===s.find("input[type=checkbox]:checked").length?u.prop("indeterminate",!1).prop("checked",!0):u.prop("indeterminate",!0).prop("checked",!1);r.length>0?u.on("click",function(t){t.stopPropagation();var e=u.prop("checked");if(r.prop("checked",e),c)n(e?!0:!1);else if(d){var a=s.find("input[type=checkbox]:checked").length;e?d.prop("disabled",!1):d.prop("disabled",!0)}}):u.prop("disabled",!0),s.on("click","input[type=checkbox]",function(t){t.stopPropagation();var e=s.find("input[type=checkbox]:checked").length;r.length===e?(r.prop("checked",!0),u.prop("indeterminate",!1).prop("checked",!0),c?n(!0):d&&d.prop("disabled",!1)):0===e?(r.prop("checked",!1),u.prop("indeterminate",!1).prop("checked",!1),c?n(!1):d&&d.prop("disabled",!0)):(u.prop("indeterminate",!0).prop("checked",!1),c?n(!0):d&&d.prop("disabled",!1))})}function setTagFilter(t){var e="undefined"!=typeof t;Foundation.utils.S("#js-tag_filter").on("click","li > a.filter-button",function(t){if(t.preventDefault(),t.stopPropagation(),!isRefreshing){isRefreshing=!0;var n=$(this),a,i,s;e?(a=Foundation.utils.S("#js-popup-update_target"),i=Foundation.utils.S("#js-popup-update_title"),s=a.parent("form").find("button[type=submit]")):(a=Foundation.utils.S("#js-update_target"),i=Foundation.utils.S("#js-update_title"),s=!1),updateTagButtonState(n);var o=i.html(),l=[],u=a.data("href");Foundation.utils.S("#js-tag_filter > li > a.selected").each(function(t){l.push($(this).attr("id"))}),i.html(MSG_LOADING),a.fadeTo(200,.33,function(){a.load(u,"subject="+l.join(),function(){a.fadeTo(200,1,function(){i.html(o),n.blur(),s&&s.prop("disabled",!0),isRefreshing=!1})})})}})}function createTag(){Foundation.utils.S("#js-createTag").submit(function(t){t.preventDefault();var e=$(this),n=Foundation.utils.S("#reveal-create_tag"),a=e.find('input[name="title"]').val();$.post(e.attr("action"),e.serialize(),null,"html").done(function(t){var i=$.parseHTML(t);$(i).find(".error").length?(n.html(t),revealInit(n)):(Foundation.utils.S("#js-tag_filter").append(' <li><a id="'+encodeURIComponent(a)+'" class="filter-button unselected"><i class="fa fa-circle no-pad"></i><i class="fa fa-circle-thin no-pad"></i>\xa0'+a+"</a>"),Foundation.utils.S("#js-update_target").empty().html(t),n.foundation("reveal","close"),setAlertBox("success",e.data("success_msg_pre")+" \xab\xa0"+a+"\xa0\xbb "+e.data("success_msg_post")))})})}function delTag(){Foundation.utils.S("#js-delTag").submit(function(t){t.preventDefault();var e=$(this),n=Foundation.utils.S("#js-update_target"),a=Foundation.utils.S("#js-update_title"),i=a.html();a.html(MSG_LOADING),n.fadeTo(200,.33,function(){$.post(e.attr("action"),e.serialize()).done(function(t){var s=document.getElementById(document.getElementsByName("tag_id")[0].value).parentNode;s.parentNode.removeChild(s),n.empty().html(t),n.fadeTo(200,1,function(){a.html(i),setAlertBox("success",e.data("success_msg_pre")+" \xab\xa0"+e.data("tag_name")+"\xa0\xbb "+e.data("success_msg_post"))})})})})}function setResTagger(){var t=Foundation.utils.S("#js-resTagger");_setTagSelector(t),t.submit(function(e){e.preventDefault();var n="form.submitted=1&formulaire=etiqueter";t.find("a.selected").each(function(t){n+="&listeTag:list="+encodeURIComponent($(this).attr("id"))}),$.post(t.attr("action"),n).done(function(e){$("#js-update_target").empty().html(e),t.parent(".reveal-modal").foundation("reveal","close"),setAlertBox("success",t.data("success_msg_pre")+" \xab\xa0"+t.data("res_name")+"\xa0\xbb "+t.data("success_msg_post"))})})}function setActionBatch(){var t=Foundation.utils.S("#tag_sel > form"),e=t.find('[type="submit"]');_setTagSelector(t),t.on("click","a.filter-button",function(){t.find("a.filter-button.selected").length?e.prop("disabled",!1):e.prop("disabled",!0)}),$(document).on("open.fndtn.reveal","#tag_sel",function(){t.find("#tagPanelMessage").remove(),t.find("a.filter-button.selected").removeClass("selected").addClass("unselected"),e.prop("disabled",!0);var n="",a=0;Foundation.utils.S('#js-update_target tbody input[name="paths:list"]:checked').each(function(t){n+="<li>"+$(this).data("res_name")+"</li>",a++}),n=a>1?t.data("p_tag_msg")+"<ul>"+n+"</ul>":t.data("s_tag_msg")+"<ul>"+n+"</ul>",t.prepend($("<div>",{id:"tagPanelMessage",class:"panel callout radius",html:n}))}),t.submit(function(e){e.preventDefault();var n="lots=lots";t.find("a.selected").each(function(t){n+="&listeTag:list="+encodeURIComponent($(this).attr("id"))}),Foundation.utils.S('#js-update_target tbody input[name="paths:list"]:checked').each(function(t){n+="&paths:list="+$(this).attr("value")}),$.post(t.attr("action"),n).done(function(e){Foundation.utils.S("#tag_sel").foundation("reveal","close"),setAlertBox("success",t.data("success_msg"))})}),Foundation.utils.S("#untag_sel > form").submit(function(t){t.preventDefault();var e=$(this),n=[],a="lots=lots";Foundation.utils.S("#js-tag_filter a.selected").each(function(t){n.push($(this).attr("id"))}),a+="&tagsupp="+n.join(),Foundation.utils.S('#js-update_target tbody input[name="paths:list"]:checked').each(function(t){a+="&paths:list="+$(this).attr("value")}),$.post(e.attr("action"),a).done(function(t){$("#js-update_target").empty().html(t),Foundation.utils.S("#untag_sel").foundation("reveal","close"),setAlertBox("success",e.data("success_msg"))})}),$(document).on("open.fndtn.reveal","#untag_sel",function(){Foundation.utils.S("#untagPanelMessage").remove();var t=Foundation.utils.S("#untag_sel > form"),e="",n="",a=0;Foundation.utils.S("#js-tag_filter a:not(#last).selected").each(function(t){e+="<li>"+$(this).text()+"</li>"}),n=t.data("untag_msg")+"<ul>"+e+"</ul>",e="",Foundation.utils.S('#js-update_target tbody input[name="paths:list"]:checked').each(function(t){e+="<li>"+$(this).data("res_name")+"</li>",a++}),n=a>1?n+t.data("p_untag_msg")+"<ul>"+e+"</ul>":n+t.data("s_untag_msg")+"<ul>"+e+"</ul>",t.prepend($("<div>",{id:"untagPanelMessage",class:"panel warning radius",html:n}))}),Foundation.utils.S("#del_sel > form").submit(function(t){t.preventDefault();var e=$(this),n="",a=e.serialize();Foundation.utils.S('#js-update_target tbody input[name="paths:list"]:checked').each(function(t){$(this).data("attached")||(a+="&paths:list="+$(this).attr("value"))}),$.post(e.attr("action"),a).done(function(t){$("#js-update_target").empty().html(t),Foundation.utils.S("#del_sel").foundation("reveal","close"),setAlertBox("success",e.data("success_msg"))})}),$(document).on("open.fndtn.reveal","#del_sel",function(){Foundation.utils.S("#suppPanelMessage").remove(),Foundation.utils.S("#attPanelMessage").remove();var t=Foundation.utils.S("#del_sel > form"),e="",n="",a=0,i=0;Foundation.utils.S('#js-update_target tbody input[name="paths:list"]:checked').each(function(t){$(this).data("attached")?(n+="<li>"+$(this).data("res_name")+"</li>",i++):(e+="<li>"+$(this).data("res_name")+"</li>",a++)}),a?(t.find("div.alert").show(),t.find('[type="submit"]').prop("disabled",!1).show(),i&&(n=i>1?t.data("p_att_msg")+"<ul>"+n+"</ul>":t.data("s_att_msg")+"<ul>"+n+"</ul>",t.prepend($("<div>",{id:"attPanelMessage",class:"panel callout radius",html:n}))),e=a>1?t.data("p_supp_msg")+"<ul>"+e+"</ul>":t.data("s_supp_msg")+"<ul>"+e+"</ul>",t.prepend($("<div>",{id:"suppPanelMessage",class:"panel warning radius",html:e}))):(t.find("div.alert").hide(),t.find('[type="submit"]').prop("disabled",!0).hide(),e=t.data("all_att_msg"),e+=i>1?" "+t.data("p_all_att_msg"):" "+t.data("s_all_att_msg"),t.prepend($("<div>",{id:"suppPanelMessage",class:"panel warning radius",html:e})))})}function setSwitchMarkup(){NB_LISTED_ELEMENTS<=250&&(Foundation.utils.S("#js-update_target .noSwitch").each(function(){$(this).removeClass("noSwitch").addClass("switch tiny round")}),Foundation.utils.S("#js-update_target .list").foundation("switch","reflow"))}function setFileEditor(){var t=Foundation.utils.S("#js-fileEditor");t.find("#title").attr("required","required").attr("placeholder",t.data("placeholder")),t.find("#archetypes-fieldname-file > span > span > img").remove(),t.find("#archetypes-fieldname-file > span > span > span.discreet > span").remove()}function setLinkCreator(){Foundation.utils.S("#js-linkCreator").submit(function(t){t.preventDefault();var e=$(this);$.post(e.attr("action"),e.serialize()).done(function(t){var e=$("#reveal-main");e.empty().html(t),revealInit(e)})})}function setBULinkSearch(){Foundation.utils.S(".js-BULinkSearch").submit(function(t){t.preventDefault();var e=$(this),n=Foundation.utils.S("#reveal-main");$.post(e.attr("action"),e.serialize()).done(function(t){n.empty().html(t),revealInit(n)})})}function setBULinkCreator(){Foundation.utils.S("#js-BULinkCreator").submit(function(t){t.preventDefault();var e=$(this);$.post(e.attr("action"),e.serialize()).done(function(t){$("#js-update_target").empty().html(t),Foundation.utils.S("#reveal-main").foundation("reveal","close"),setAlertBox("success",e.data("success_msg"))})})}function setLinkEditor(){var t=Foundation.utils.S("#js-linkEditor");t.find("#title, #lecteur").attr("required","required").attr("placeholder",t.data("placeholder")),t.find("#lecteur_text_format").parent("div").remove(),Foundation.utils.S("#js-linkEditor").submit(function(e){e.preventDefault();var n=Foundation.utils.S("#reveal-main");$.post(t.attr("action"),t.serialize()).done(function(e){var a=$.parseHTML(e);$(a).find(".error").length?(n.empty().html(e),revealInit(n)):($("#js-update_target").empty().html(e),n.foundation("reveal","close"),t.find("#title").length?setAlertBox("success",t.data("success_msg_pre")+" \xab\xa0"+t.find("#title").attr("value")+"\xa0\xbb "+t.data("success_msg_post")):setAlertBox("success",t.data("success_msg_pre")+" \xab\xa0"+t.find("h3").text()+"\xa0\xbb "+t.data("success_msg_post")))})})}function setGlossaryEditor(){var t=Foundation.utils.S("#js-glossaryEditor");t.find("#title, #description").attr("required","required").attr("placeholder",t.data("placeholder")),setRevealForm("js-glossaryEditor","reveal-main")}function setItemSuppressor(){Foundation.utils.S("#js-itemSuppressor").submit(function(t){t.preventDefault();var e=$(this);$.post(e.attr("action"),e.serialize()).done(function(t){$("#js-update_target").empty().html(t),e.parent(".reveal-modal").foundation("reveal","close"),setAlertBox("success"," \xab\xa0"+e.data("item_name")+"\xa0\xbb "+e.data("success_msg"))})})}function setResDetacher(){var t=Foundation.utils.S("#js-resDetacher"),e=t.find('[type="submit"]');e.prop("disabled",!0),_setTagSelector(t),t.on("click","a.filter-button",function(){t.find("a.filter-button.selected").length?e.prop("disabled",!1):e.prop("disabled",!0)}),t.submit(function(e){e.preventDefault();var n=[],a=t.serialize();t.find("a.selected").each(function(t){a+="&listeCours:list="+$(this).attr("id"),n.push("\xab\xa0"+$(this).data("course_name")+"\xa0\xbb")}),$.post(t.attr("action"),a).done(function(e){$("#js-update_target").empty().html(e),t.parent(".reveal-modal").foundation("reveal","close"),setAlertBox("success",t.data("success_msg_pre")+" \xab\xa0"+t.data("res_name")+"\xa0\xbb "+t.data("success_msg_post")+"\xa0: "+n.join(", ")+".")})})}function setCourseDuplicator(){Foundation.utils.S("#js-courseDuplicator").submit(function(t){t.preventDefault();var e=$(this);$.post(e.attr("action"),e.serialize()).done(function(t){Foundation.utils.S("#js-update_target").empty().html(t),Foundation.utils.S("#reveal-main").foundation("reveal","close"),setAlertBox("success",e.data("success_msg_pre")+" \xab\xa0"+e.data("course_name")+"\xa0\xbb "+e.data("success_msg_post"))})})}function setAttachmentCreator(){setTagFilter(!0),Foundation.utils.S("#js-attachmentCreator").submit(function(t){t.preventDefault();var e=$(this);$.post(e.attr("action"),e.serialize()).done(function(t){$.get(t).done(function(t){$("#course_plan-plan").html(t),Foundation.utils.S("#reveal-main-large").foundation("reveal","close"),$(document).foundation("dropdown","reflow"),setAlertBox("success",e.data("success_msg"))})})})}function setSortablePlan(){if(matchMedia(Foundation.media_queries.small).matches&&!matchMedia(Foundation.media_queries.medium).matches)setPlanChapterDisclosure(!0),setPlanBehaviors(!0),setStaffPlanChapterDiscloseCommand();else{var t=Foundation.utils.S("#course_plan-plan");t.find(".elemtextelibre > span:first-of-type li").addClass("js-unsortable"),t.nestedSortable({items:"li:not(.js-unsortable)",handle:"div",tabSize:20,isTree:!0,maxLevels:5,doNotClear:!0,expandOnHover:700,startCollapsed:!1,placeholder:"placeholder",expression:"([^-=_]*)[-=_](.+)",rootID:"course_plan-plan",leafClass:"leaf",branchClass:"branch",disabledClass:"legend",hoveringClass:"hovering",expandedClass:"expanded",collapsedClass:"collapsed",disableNestingClass:"element",errorClass:"error",update:function(e,n){if(!isRefreshing){isRefreshing=!0;var a=Foundation.utils.S("#js-update_title"),i=a.html();a.html(MSG_LOADING),Foundation.utils.S(".tooltip").hide(),t.fadeTo(200,.33,function(){$.ajax({type:"POST",url:ABSOLUTE_URL+"/order_course_map_item_script",data:{plan:t.nestedSortable("serialize"),classe:n.item[0].className,idAttente:n.item[0].id},success:function(t){},error:function(t,e,n){console.log(n),console.log(e)},complete:function(){a.html(MSG_LOADING_OK),t.fadeTo(200,1,function(){a.html(i),isRefreshing=!1})}})})}}}),setPlanBehaviors(!0),setStaffPlanChapterDiscloseCommand()}}function expandPlanChapters(){Foundation.utils.S("#course_plan-plan li.branch:not(.element)").addClass("expanded")}function setStaffPlanChapterDisclosure(t){if(!isRefreshing){isRefreshing=!0;var e=Foundation.utils.S("#course_plan-plan"),n=Foundation.utils.S("#js-update_title"),a=n.html();n.html(MSG_LOADING),e.fadeTo(200,.33,function(){$.ajax({type:"GET",url:ABSOLUTE_URL+"/open_course_map_item_script",data:{id:"all",open:t},success:function(i){n.html(MSG_LOADING_OK),setPlanChapterDisclosure(t),e.fadeTo(200,1,function(){n.html(a)})},error:function(t,e,n){console.log(n),console.log(e)},complete:function(){isRefreshing=!1}})})}}function setStaffPlanChapterDiscloseCommand(){var t=Foundation.utils.S("#course_plan-plan");t.on("click",".js-disclose",function(){if(!isRefreshing){isRefreshing=!0;var e=$(this),n=e.closest("li"),a=Foundation.utils.S("#js-update_title"),i=a.html();a.html(MSG_LOADING),t.fadeTo(200,.33,function(){$.ajax({type:"GET",url:ABSOLUTE_URL+"/open_course_map_item_script",data:{id:n.attr("id"),open:n.hasClass("collapsed")},success:function(n){a.html(MSG_LOADING_OK),setPlanChapterDisclose(e),t.fadeTo(200,1,function(){a.html(i)})},error:function(t,e,n){console.log(n),console.log(e)},complete:function(){isRefreshing=!1}})})}})}function _setTokenParams(){tokenParams={minChars:4,hintText:MSG_TOKEN_HINT_TEXT,searchingText:MSG_TOKEN_SEARCH_TEXT,noResultsText:MSG_TOKEN_EMPTY_TEXT,preventDuplicates:!0}}function setLDAPSearch(){_setTokenParams(),Foundation.utils.S("#input-groupe").tokenInput(ABSOLUTE_URL+"/rechercherUser",$.extend({},tokenParams,{queryParam:"groupe"}))}function setAuthorMod(){_setTokenParams(),Foundation.utils.S("#input-auteurs").tokenInput(ABSOLUTE_URL+"/rechercherUser",$.extend({},tokenParams,{queryParam:"coauteur",tokenLimit:1}))}function setCoAuthorReaderMod(){_setTokenParams(),Foundation.utils.S("#input-coauteurs").tokenInput(ABSOLUTE_URL+"/rechercherUser",$.extend({},tokenParams,{queryParam:"coauteur"}))}function setApogeeSearch(){Foundation.utils.S("#js-Apogee_search").submit(function(t){t.preventDefault();var e=$(this),n=Foundation.utils.S("#reveal-main");$.post(e.attr("action"),e.serialize()).done(function(t){n.empty().html(t),revealInit(n)})})}function setUESendMail(){Foundation.utils.S("#js-UESendMail").submit(function(t){t.preventDefault();var e=$(this),n=Foundation.utils.S("#reveal-etudiants");$.post(e.attr("action"),e.serialize()).done(function(t){var a=$.parseHTML(t);$(a).find(".fieldErrorBox").text()?(n.empty().html(t),revealInit(n)):(n.foundation("reveal","close"),setAlertBox("success",e.data("success_msg")))})})}function setWimsExportAccordionRadio(t){var e=Foundation.utils.S("#"+t),n=e.parent("form"),a=n.children(".formControls").children("[type=submit]");e.on("toggled",function(t,e){var n=$(this).find(".content.active").attr("id");void 0!==n?(switchButtonEnabledState(a,!0),Foundation.utils.S("#js-export_format").prop("value",n),Foundation.utils.S("#"+n+"_default").prop("checked",!0)):switchButtonEnabledState(a,!1)})}function closeDownloadModal(t){var e=Foundation.utils.S("#"+t);e.submit(function(t){Foundation.utils.S("#reveal-main").foundation("reveal","close"),setAlertBox("info",e.data("success_msg"))})}function setWimsGroupCreator(){$(document).on("open.fndtn.reveal","#group_create",function(){Foundation.utils.S("#groupPanelMessage").remove(),Foundation.utils.S("#noGroupPanelMessage").remove();var t=Foundation.utils.S("#js-wimsGroupCreator"),e,n="",a="",i=0,s=0;Foundation.utils.S('#js-update_target tbody input[name="paths:list"]:checked').each(function(o){$(this).data("no_group")?(a+="<li>"+$(this).data("res_name")+"</li>",s++):(e=$("<input>",{type:"hidden",value:$(this).val()}).attr("name","paths:list"),t.append(e),n+="<li>"+$(this).data("res_name")+"</li>",i++)}),i?(t.find(".field").show(),t.find('[type="submit"]').prop("disabled",!1).show(),s&&(a=s>1?t.data("p_no_msg")+"<ul>"+a+"</ul>":t.data("s_no_msg")+"<ul>"+a+"</ul>",t.prepend($("<div>",{id:"noGroupPanelMessage",class:"panel warning radius",html:a}))),n=i>1?t.data("p_yes_msg")+"<ul>"+n+"</ul>":t.data("s_yes_msg")+"<ul>"+n+"</ul>",t.prepend($("<div>",{id:"groupPanelMessage",class:"panel callout radius",html:n}))):(t.find(".field").hide(),t.find('[type="submit"]').prop("disabled",!0).hide(),a=t.data("all_no_msg"),a+=s>1?" "+t.data("p_all_no_msg"):" "+t.data("s_all_no_msg"),t.prepend($("<div>",{id:"groupPanelMessage",class:"panel warning radius",html:a})))})}function setQCMSuite(){var t=Foundation.utils.S("#supprimerQuestion");Foundation.utils.S("#ajouterQuestion").on("click",function(){var e=Foundation.utils.S(".question"),n=e.length,a=$(e[0]),i=a.clone();i.find("input, textarea").each(function(){$(this).val("");var t=$(this).parent().attr("data-name")+n;$(this).attr("name",t),$(this).attr("id",t)}),i.find("label").each(function(){$(this).attr("for",$(this).parent().attr("data-name")+n)}),i.find("legend").each(function(){$(this).html($(this).attr("data-titre")+(n+1))}),i.insertAfter($(e[n-1])).hide().fadeIn("slow"),t.is(":hidden")&&n>0&&t.fadeIn(),Foundation.utils.S("#nb_questions").val(n+1)}),t.on("click",function(){$(".question:last").fadeOut("slow",function(){$(this).remove();var e=Foundation.utils.S(".question").length;Foundation.utils.S("#nb_questions").val(e),e<2&&t.fadeOut()})})}function setRevealFormPlanRefresh(t,e,n){n="undefined"!=typeof n&&instantiateCKEditor(n),Foundation.utils.S("#"+t).submit(function(t){n&&CKEDITOR.instances[n].updateElement(),t.preventDefault();var a=$(this),i=Foundation.utils.S("#"+e);$.post(a.attr("action"),a.serialize()).done(function(t){"http"===t.split(":")[0]?$.get(t).done(function(t){$("#course_plan-plan").html(t),i.foundation("reveal","close"),setAlertBox("success",a.data("success_msg"))}):(i.empty().html(t),revealInit(i))})})}function setRevealForm(t,e,n){n="undefined"!=typeof n&&instantiateCKEditor(n),Foundation.utils.S("#"+t).submit(function(t){n&&CKEDITOR.instances[n].updateElement(),t.preventDefault(),$form=$(this);var a=Foundation.utils.S("#"+e);$.post($form.attr("action"),$form.serialize()).done(function(t){var e=$.parseHTML(t);$(e).find(".error").length?(a.empty().html(t),revealInit(a)):(Foundation.utils.S("#js-update_target").empty().html(t),a.foundation("reveal","close"),setAlertBox("success",$form.data("success_msg_pre")+" \xab\xa0"+$form.find("#title").val()+"\xa0\xbb "+$form.data("success_msg_post")))})})}function setPodFilterSelector(){var t=Foundation.utils.S("#js-podFilterSelector"),e=Foundation.utils.S("#term_search_label"),n=Foundation.utils.S("#term_search"),a=t.data("term_search_label1"),i=t.data("term_search_label2"),s=t.data("term_search_placeholder1"),o=t.data("term_search_placeholder2");Foundation.utils.S("#type_search").on("change",function(){"mes_videos"===$(this).val()?(e.text(i),n.attr("placeholder",o)):(e.text(a),n.attr("placeholder",s))})}function setPodContentMultipleSelection(){function t(t){return!(e.find('ul > li .switch > [type="checkbox"]:checked').length&&!confirm(s))||(t.preventDefault(),t.stopPropagation(),!1)}var e=Foundation.utils.S("#js-podContentsList"),n=e.find('[name="form.button.save"]'),a=Foundation.utils.S("#pagination-page_number"),i=a.find('[name="page"]'),s=a.data("page_change_msg1")+"\n"+a.data("page_change_msg2"),o=i.val();switchButtonEnabledState(n,!1),e.on("change",'ul > li .switch > [type="checkbox"]',function(){e.find('ul > li .switch > [type="checkbox"]:checked').length?switchButtonEnabledState(n,!0):switchButtonEnabledState(n,!1)}),Foundation.utils.S("#pagination-container").on("click","a.button",function(e){t(e)}),a.submit(function(e){t(e)||i.val(o)})}function setMailRegistrationForm(){function t(t){if(Boolean(t.trim().length)){var e=t.split(","),n,a;for(e=e.filter(function(t){return""!==t}),n=0,a=e.length;n<a;++n){if(e[n]=e[n].trim(),e[n].search(">")!==e[n].length-1)return!1;var i=e[n].replace(">","").split("<");if(2!==i.length)return!1;var o=new RegExp(s.find("input[name=lastname]").attr("pattern")),l=new RegExp(s.find("input[name=email]").attr("pattern"));if(!o.test(i[0])||!l.test(i[1]))return!1}return!0}return!1}var e=Foundation.utils.S("#js-mailRegistration"),n=e.children("fieldset"),a=e.find("button[type=submit]"),i=[],s=Foundation.utils.S("#js-mailRegistrationList"),o=s.find("input[name=lastname]"),l=Foundation.utils.S("#mailUserList"),u=s.find("tbody"),r="",d="",c="",p="",f="",m=!1;switchButtonEnabledState(a,!1),Foundation.utils.S("#js-modeSwitcher").on("click",function(t){s.is(":visible")?u.fadeOut("fast",function(){s.fadeOut("slow",function(){n.fadeIn("slow"),switchButtonEnabledState(a,!0),l.focus().attr("required","required")})}):n.fadeOut("slow",function(){s.fadeIn("slow",function(){u.fadeIn("fast",function(){u.find("tr").length?switchButtonEnabledState(a,!0):switchButtonEnabledState(a,!1),o.focus(),l.removeAttr("required")})})})}),e.submit(function(a){s.is(":visible")?(u.find("tr").each(function(t){i.push($(this).data("user_info"))}),l.val(i.join(", ")),revealFormOnSubmitBehavior(s)):t(l.val())?revealFormOnSubmitBehavior(e):(a.preventDefault(),n.find(".fieldErrorBox").html(MSG_FORM_VALIDATION_ERROR))}),s.submit(function(t){t.preventDefault(),c=s.find("input[name=firstname]").val().trim(),d=o.val().trim(),p=s.find("input[name=email]").val().trim(),f=c+" "+d+" <"+p+">",m=!1,s.find("input").val(""),r='<tr class="hide" data-user_info="'+f+'">',r+='<td class="name">'+d+'</td><td class="name">'+c+'</td><td class="email">'+p+"</td><td>",r+='<a title="Retirer de la liste"><i class="fa fa-minus-circle fa-lg fa-fw no-pad warning"></i></a></td></tr>',u.find("tr").length?u.find("tr").each(function(){if($(this).data("user_info")===f||$(this).children("td.email").html()===p)return m=!0,!1}):s.find("div.panel:last-child").slideDown("slow",function(){switchButtonEnabledState(a,!0)}),m||($(r).appendTo(u).show("slow"),o.focus())}),u.on("click","a",function(t){t.preventDefault(),t.stopPropagation(),$(this).closest("tr").hide("slow",function(){$(this).remove(),u.find("tr").length||s.find("div.panel:last-child").slideUp("slow",function(){switchButtonEnabledState(a,!1)}),o.focus()})})}function switchButtonEnabledState(t,e){e?t.prop("disabled",!1):t.prop("disabled",!0)}function enableSubmitButtonIfCheckboxTicked(t){var e=Foundation.utils.S("#"+t).children(".formControls"),n=e.children("[type=submit]");e.find("[type=checkbox]").on("click",function(t){$(this).prop("checked")?switchButtonEnabledState(n,!0):switchButtonEnabledState(n,!1)})}function displayMessageOnSubmit(t){var e=Foundation.utils.S("#"+t),n=e.children(".formControls"),a=e.children(".panel.hide");e.on("click","[type=submit]",function(t){t.preventDefault(),t.stopPropagation(),n.fadeOut("fast",function(){a.fadeIn("fast",function(){e.submit()})})})}function preventMultipleFormSubmits(t){Foundation.utils.S("#"+t).find("form").submit(function(t){$(this).find('[type="submit"]').prop("disabled",!0)})}function _setTagSelector(t){t.on("click","a.filter-button",function(t){t.preventDefault(),t.stopPropagation(),updateTagButtonState($(this))})}function updateTagButtonState(t){return t.hasClass("unselected")?(t.removeClass("unselected").addClass("selected").blur(),!0):t.hasClass("selected")?(t.removeClass("selected").addClass("unselected").blur(),!1):void 0}function setDateTimePicker(t){if(!Modernizr.inputtypes.datetime){var e=new Date,n=e.getFullYear();Foundation.utils.S("#"+t).datetimepicker({inline:!0,lang:"fr",format:"Y/m/d H:i",weeks:!1,minDate:0,step:15,yearStart:n,yearEnd:n+1,scrollMonth:!1,scrollYear:!1})}}function refreshWebconfList(){function t(){var t=Foundation.utils.S("#js-update_target"),e=Foundation.utils.S("#js-update_title"),n=e.html();e.html(MSG_LOADING),t.fadeTo(200,.33,function(){t.load(window.location.pathname,function(){t.fadeTo(200,1,function(){e.html(n)})})})}var e=Foundation.utils.S("#reveal-connect");Foundation.utils.S("#connect").on("click",function(t){e.foundation("reveal","open")}),e.find("a.button").on("click",function(n){e.foundation("reveal","close"),t()})}function refreshIframe(t,e,n){for(var a in n)"0"===a?document.getElementById(n[a]).classList.add("selected"):document.getElementById(n[a]).classList.remove("selected");$("#insert_wims").fadeOut(),document.getElementById(t).src=e,$("#insert_wims").fadeIn()}var tokenParams={};$.datetimepicker.setLocale("fr");