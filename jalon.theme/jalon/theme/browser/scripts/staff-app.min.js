function setBatchSelect(t,e){function a(t){t?(o.removeClass("inactive"),switchButtonEnabledState(n.find('.formControls > [type="submit"]'),!0)):(o.addClass("inactive"),switchButtonEnabledState(n.find('.formControls > [type="submit"]'),!1))}var n=Foundation.utils.S("#"+t),i=n.find("thead"),s=n.find("tbody"),o=n.find("tfoot a.dropdown"),l=n.find("thead .checkall input[type=checkbox]").attr("role"),u=i.find('.checkall input[role="'+l+'"]'),r=s.find('input[name="'+l+'"]'),d=("js-createAnnounce"===t||"js-mod-annonce"===t)&&Foundation.utils.S("#mailAnnounce"),c=void 0===e||!e;if(c)r.prop("checked",!1),u.prop("checked",!1),o.on("click",function(t){$(this).hasClass("inactive")&&(t.preventDefault(),t.stopPropagation())});else if(d){var p=s.find("input[type=checkbox]:checked").length;r.length===p?(u.prop("indeterminate",!1).prop("checked",!0),d.prop("disabled",!1)):p?(u.prop("indeterminate",!0).prop("checked",!1),d.prop("disabled",!1)):(u.prop("indeterminate",!1).prop("checked",!1),d.prop("disabled",!0))}else r.length===s.find("input[type=checkbox]:checked").length?u.prop("indeterminate",!1).prop("checked",!0):u.prop("indeterminate",!0).prop("checked",!1);r.length>0?u.on("click",function(t){t.stopPropagation();var e=u.prop("checked");if(r.prop("checked",e),c)a(e?!0:!1);else if(d){var n=s.find("input[type=checkbox]:checked").length;e?d.prop("disabled",!1):d.prop("disabled",!0)}}):u.prop("disabled",!0),s.on("click","input[type=checkbox]",function(t){t.stopPropagation();var e=s.find("input[type=checkbox]:checked").length;r.length===e?(r.prop("checked",!0),u.prop("indeterminate",!1).prop("checked",!0),c?a(!0):d&&d.prop("disabled",!1)):0===e?(r.prop("checked",!1),u.prop("indeterminate",!1).prop("checked",!1),c?a(!1):d&&d.prop("disabled",!0)):(u.prop("indeterminate",!0).prop("checked",!1),c?a(!0):d&&d.prop("disabled",!1))})}function setTagFilter(t){var e=void 0!==t;Foundation.utils.S("#js-tag_filter").on("click","li > a.filter-button",function(t){if(t.preventDefault(),t.stopPropagation(),!isRefreshing){isRefreshing=!0;var a=$(this),n,i,s;e?(n=Foundation.utils.S("#js-popup-update_target"),i=Foundation.utils.S("#js-popup-update_title"),s=n.parent("form").find("button[type=submit]")):(n=Foundation.utils.S("#js-update_target"),i=Foundation.utils.S("#js-update_title"),s=!1),updateTagButtonState(a);var o=i.html(),l=[],u=n.data("href");Foundation.utils.S("#js-tag_filter > li > a.selected").each(function(t){l.push($(this).attr("id"))}),i.html(MSG_LOADING),n.fadeTo(200,.33,function(){n.load(u,"subject="+l.join(),function(){n.fadeTo(200,1,function(){i.html(o),a.blur(),s&&s.prop("disabled",!0),isRefreshing=!1})})})}})}function _checkDuplicateTag(t,e){var a=removeDiacritics(t.trim().replace(/\s+/g," ")).toLowerCase(),n="",i=!1;return void 0!==e&&(n=":not(#"+e+")"),$("#js-tag_filter > li > a:not(#last)"+n).each(function(t){if(existingTag=removeDiacritics($(this).text().trim().replace(/\s+/g," ")).toLowerCase(),existingTag===a)return i=!0,!1}),i}function createTag(){Foundation.utils.S("#js-createTag").submit(function(t){t.preventDefault();var e=$(this),a=Foundation.utils.S("#reveal-tags"),n=a.find("#archetypes-fieldname-title"),i=n.find("> .fieldErrorBox"),s=n.find('> input[name="title"]'),o=e.find('input[name="tag_id"]').val(),l=s.val().trim().replace(/\s+/g," ");s.val(l),_checkDuplicateTag(l)?i.length?i.text(e.data("error_msg_duplicate")):n.append('<div class="fieldErrorBox">'+e.data("error_msg_duplicate")+"</div>"):(i.length&&i.remove(),revealFormOnSubmitBehavior(e),$.post(e.attr("action"),e.serialize(),null,"html").done(function(t){var n=$.parseHTML(t);$(n).find(".error").length?(a.html(t),revealInit(a)):(Foundation.utils.S("#js-tag_filter").append(' <li><a id="'+o+'" class="filter-button unselected"><i class="fa fa-circle no-pad"></i><i class="fa fa-circle-thin no-pad"></i>\xa0'+l+"</a>"),Foundation.utils.S("#js-update_target").empty().html(t),a.foundation("reveal","close"),setAlertBox("success",e.data("success_msg_pre")+" \xab\xa0"+l+"\xa0\xbb "+e.data("success_msg_post")))}))})}function editTag(){var t=Foundation.utils.S("#js-editTag"),e=t.find('input[name="tag_id"]'),a=t.find('input[name="title"]'),n=t.find('button[name="form.button.edit_tag"]'),i="";t.on("change",'select[name="tag_list"]',function(){var s=$(this).find("option:selected").val(),o=t.data("empty_text");i=$(this).find("option:selected").text().trim(),"0"===s?(e.val("0"),a.val(o).attr("readonly","readonly"),n.attr("disabled","disabled")):(e.val(s),a.val(i).removeAttr("readonly"),n.removeAttr("disabled"))}),t.submit(function(e){e.preventDefault();var a=Foundation.utils.S("#reveal-tags"),n=a.find("#archetypes-fieldname-title"),s=n.find("> .fieldErrorBox"),o=t.find('input[name="tag_id"]').val(),l=n.find('input[name="title"]').val().trim().replace(/\s+/g," "),u="";l===i?u=t.data("error_msg_identical"):_checkDuplicateTag(l,o)&&(u=t.data("error_msg_duplicate")),""===u?(s.length&&s.remove(),revealFormOnSubmitBehavior(t),$.post(t.attr("action"),t.serialize(),null,"html").done(function(e){var n=$.parseHTML(e);$(n).find(".error").length?(a.html(e),revealInit(a)):($("#"+o).html('<i class="fa fa-circle no-pad"></i><i class="fa fa-circle-thin no-pad"></i> '+l),a.foundation("reveal","close"),setAlertBox("success",t.data("success_msg_pre")+" \xab\xa0"+i+"\xa0\xbb "+t.data("success_msg_post")+" \xab\xa0"+l+"\xa0\xbb."))})):s.length?s.text(u):n.append('<div class="fieldErrorBox">'+u+"</div>")})}function delTag(){Foundation.utils.S("#js-delTag").submit(function(t){t.preventDefault();var e=$(this),a=Foundation.utils.S("#js-update_target"),n=Foundation.utils.S("#js-update_title"),i=n.html();n.html(MSG_LOADING),a.fadeTo(200,.33,function(){$.post(e.attr("action"),e.serialize()).done(function(t){$("#"+e.children("input[name=tag_id]").val()).parent("li").remove(),a.empty().html(t),a.fadeTo(200,1,function(){n.html(i),setAlertBox("success",e.data("success_msg_pre")+" \xab\xa0"+e.data("tag_name")+"\xa0\xbb "+e.data("success_msg_post"))})})})})}function setResTagger(){var t=Foundation.utils.S("#js-resTagger");_setTagSelector(t),t.submit(function(e){e.preventDefault();var a="form.submitted=1&formulaire=etiqueter";t.find("a.selected").each(function(t){a+="&listeTag:list="+$(this).attr("id")}),$.post(t.attr("action"),a).done(function(e){$("#js-update_target").empty().html(e),t.parent(".reveal-modal").foundation("reveal","close"),setAlertBox("success",t.data("success_msg_pre")+" \xab\xa0"+t.data("res_name")+"\xa0\xbb "+t.data("success_msg_post"))})})}function setActionBatch(){var t=Foundation.utils.S("#tag_sel > form"),e=t.find('[type="submit"]');_setTagSelector(t),t.on("click","a.filter-button",function(){t.find("a.filter-button.selected").length?e.prop("disabled",!1):e.prop("disabled",!0)}),$(document).on("open.fndtn.reveal","#tag_sel",function(){t.find("#tagPanelMessage").remove(),t.find("a.filter-button.selected").removeClass("selected").addClass("unselected"),e.prop("disabled",!0);var a="",n=0;Foundation.utils.S('#js-update_target tbody input[name="paths:list"]:checked').each(function(t){a+="<li>"+$(this).data("res_name")+"</li>",n++}),a=n>1?t.data("p_tag_msg")+"<ul>"+a+"</ul>":t.data("s_tag_msg")+"<ul>"+a+"</ul>",t.prepend($("<div>",{id:"tagPanelMessage",class:"panel callout radius",html:a}))}),t.submit(function(e){e.preventDefault();var a="lots=lots";t.find("a.selected").each(function(t){a+="&listeTag:list="+$(this).attr("id")}),Foundation.utils.S('#js-update_target tbody input[name="paths:list"]:checked').each(function(t){a+="&paths:list="+$(this).attr("value")}),$.post(t.attr("action"),a).done(function(e){Foundation.utils.S("#tag_sel").foundation("reveal","close"),setAlertBox("success",t.data("success_msg"))})}),Foundation.utils.S("#untag_sel > form").submit(function(t){t.preventDefault();var e=$(this),a=[],n="lots=lots";Foundation.utils.S("#js-tag_filter a.selected").each(function(t){a.push($(this).attr("id"))}),n+="&tagsupp="+a.join(),Foundation.utils.S('#js-update_target tbody input[name="paths:list"]:checked').each(function(t){n+="&paths:list="+$(this).attr("value")}),$.post(e.attr("action"),n).done(function(t){$("#js-update_target").empty().html(t),Foundation.utils.S("#untag_sel").foundation("reveal","close"),setAlertBox("success",e.data("success_msg"))})}),$(document).on("open.fndtn.reveal","#untag_sel",function(){Foundation.utils.S("#untagPanelMessage").remove();var t=Foundation.utils.S("#untag_sel > form"),e="",a="",n=0;Foundation.utils.S("#js-tag_filter a:not(#last).selected").each(function(t){e+="<li>"+$(this).text()+"</li>"}),a=t.data("untag_msg")+"<ul>"+e+"</ul>",e="",Foundation.utils.S('#js-update_target tbody input[name="paths:list"]:checked').each(function(t){e+="<li>"+$(this).data("res_name")+"</li>",n++}),a=n>1?a+t.data("p_untag_msg")+"<ul>"+e+"</ul>":a+t.data("s_untag_msg")+"<ul>"+e+"</ul>",t.prepend($("<div>",{id:"untagPanelMessage",class:"panel warning radius",html:a}))}),Foundation.utils.S("#del_sel > form").submit(function(t){t.preventDefault();var e=$(this),a="",n=e.serialize();Foundation.utils.S('#js-update_target tbody input[name="paths:list"]:checked').each(function(t){$(this).data("attached")||(n+="&paths:list="+$(this).attr("value"))}),$.post(e.attr("action"),n).done(function(t){$("#js-update_target").empty().html(t),Foundation.utils.S("#del_sel").foundation("reveal","close"),setAlertBox("success",e.data("success_msg"))})}),$(document).on("open.fndtn.reveal","#del_sel",function(){Foundation.utils.S("#suppPanelMessage").remove(),Foundation.utils.S("#attPanelMessage").remove();var t=Foundation.utils.S("#del_sel > form"),e="",a="",n=0,i=0;Foundation.utils.S('#js-update_target tbody input[name="paths:list"]:checked').each(function(t){$(this).data("attached")?(a+="<li>"+$(this).data("res_name")+"</li>",i++):(e+="<li>"+$(this).data("res_name")+"</li>",n++)}),n?(t.find("div.alert").show(),t.find('[type="submit"]').prop("disabled",!1).show(),i&&(a=i>1?t.data("p_att_msg")+"<ul>"+a+"</ul>":t.data("s_att_msg")+"<ul>"+a+"</ul>",t.prepend($("<div>",{id:"attPanelMessage",class:"panel callout radius",html:a}))),e=n>1?t.data("p_supp_msg")+"<ul>"+e+"</ul>":t.data("s_supp_msg")+"<ul>"+e+"</ul>",t.prepend($("<div>",{id:"suppPanelMessage",class:"panel warning radius",html:e}))):(t.find("div.alert").hide(),t.find('[type="submit"]').prop("disabled",!0).hide(),e=t.data("all_att_msg"),e+=i>1?" "+t.data("p_all_att_msg"):" "+t.data("s_all_att_msg"),t.prepend($("<div>",{id:"suppPanelMessage",class:"panel warning radius",html:e})))})}function setSwitchMarkup(){NB_LISTED_ELEMENTS<=250&&(Foundation.utils.S("#js-update_target .noSwitch").each(function(){$(this).removeClass("noSwitch").addClass("switch tiny round")}),Foundation.utils.S("#js-update_target .list").foundation("switch","reflow"))}function setFileEditor(){var t=Foundation.utils.S("#js-fileEditor");t.find("#title").attr("required","required").attr("placeholder",t.data("placeholder")),t.find("#archetypes-fieldname-file > span > span > img").remove(),t.find("#archetypes-fieldname-file > span > span > span.discreet > span").remove()}function setLinkCreator(){Foundation.utils.S("#js-linkCreator").submit(function(t){t.preventDefault();var e=$(this);$.post(e.attr("action"),e.serialize()).done(function(t){var e=$("#reveal-main");e.empty().html(t),revealInit(e)})})}function setBULinkSearch(){Foundation.utils.S(".js-BULinkSearch").submit(function(t){t.preventDefault();var e=$(this),a=Foundation.utils.S("#reveal-main");$.post(e.attr("action"),e.serialize()).done(function(t){a.empty().html(t),revealInit(a)})})}function setBULinkCreator(){Foundation.utils.S("#js-BULinkCreator").submit(function(t){t.preventDefault();var e=$(this);$.post(e.attr("action"),e.serialize()).done(function(t){$("#js-update_target").empty().html(t),Foundation.utils.S("#reveal-main").foundation("reveal","close"),setAlertBox("success",e.data("success_msg"))})})}function setLinkEditor(){var t=Foundation.utils.S("#js-linkEditor");t.find("#title, #lecteur").attr("required","required").attr("placeholder",t.data("placeholder")),t.find("#lecteur_text_format").parent("div").remove(),Foundation.utils.S("#js-linkEditor").submit(function(e){e.preventDefault();var a=Foundation.utils.S("#reveal-main");$.post(t.attr("action"),t.serialize()).done(function(e){var n=$.parseHTML(e);$(n).find(".error").length?(a.empty().html(e),revealInit(a)):($("#js-update_target").empty().html(e),a.foundation("reveal","close"),t.find("#title").length?setAlertBox("success",t.data("success_msg_pre")+" \xab\xa0"+t.find("#title").attr("value")+"\xa0\xbb "+t.data("success_msg_post")):setAlertBox("success",t.data("success_msg_pre")+" \xab\xa0"+t.find("h3").text()+"\xa0\xbb "+t.data("success_msg_post")))})})}function setGlossaryEditor(){var t=Foundation.utils.S("#js-glossaryEditor");t.find("#title, #description").attr("required","required").attr("placeholder",t.data("placeholder")),setRevealForm("js-glossaryEditor","reveal-main")}function setItemSuppressor(){Foundation.utils.S("#js-itemSuppressor").submit(function(t){t.preventDefault();var e=$(this);$.post(e.attr("action"),e.serialize()).done(function(t){$("#js-update_target").empty().html(t),e.parent(".reveal-modal").foundation("reveal","close"),setAlertBox("success"," \xab\xa0"+e.data("item_name")+"\xa0\xbb "+e.data("success_msg"))})})}function setResDetacher(){var t=Foundation.utils.S("#js-resDetacher"),e=t.find('[type="submit"]');e.prop("disabled",!0),_setTagSelector(t),t.on("click","a.filter-button",function(){t.find("a.filter-button.selected").length?e.prop("disabled",!1):e.prop("disabled",!0)}),t.submit(function(e){e.preventDefault();var a=[],n=t.serialize();t.find("a.selected").each(function(t){n+="&listeCours:list="+$(this).attr("id"),a.push("\xab\xa0"+$(this).data("course_name")+"\xa0\xbb")}),$.post(t.attr("action"),n).done(function(e){$("#js-update_target").empty().html(e),t.parent(".reveal-modal").foundation("reveal","close"),setAlertBox("success",t.data("success_msg_pre")+" \xab\xa0"+t.data("res_name")+"\xa0\xbb "+t.data("success_msg_post")+"\xa0: "+a.join(", ")+".")})})}function setCourseDuplicator(){Foundation.utils.S("#js-courseDuplicator").submit(function(t){t.preventDefault();var e=$(this);$.post(e.attr("action"),e.serialize()).done(function(t){Foundation.utils.S("#js-update_target").empty().html(t),Foundation.utils.S("#reveal-main").foundation("reveal","close"),setAlertBox("success",e.data("success_msg_pre")+" \xab\xa0"+e.data("course_name")+"\xa0\xbb "+e.data("success_msg_post"))})})}function setAttachmentCreator(){setTagFilter(!0),Foundation.utils.S("#js-attachmentCreator").submit(function(t){t.preventDefault();var e=$(this);$.post(e.attr("action"),e.serialize()).done(function(t){$.get(t).done(function(t){$("#course_plan-plan").html(t),setLegendBarButtonsState(),e.parents(".reveal-modal").foundation("reveal","close"),setAlertBox("success",e.data("success_msg"))})})})}function setSortablePlan(){var t=Foundation.utils.S("#course_plan-plan");matchMedia(Foundation.media_queries.small).matches&&!matchMedia(Foundation.media_queries.medium).matches||t.nestedSortable({items:"li",handle:"div",tabSize:20,isTree:!0,maxLevels:5,doNotClear:!0,expandOnHover:700,startCollapsed:!1,placeholder:"placeholder",expression:"([^-=_]*)[-=_](.+)",rootID:"course_plan-plan",leafClass:"leaf",branchClass:"branch",disabledClass:"legend",hoveringClass:"hovering",expandedClass:"expanded",collapsedClass:"collapsed",disableNestingClass:"element",errorClass:"error",update:function(e,a){if(!isRefreshing){isRefreshing=!0;var n=Foundation.utils.S("#js-update_title"),i=n.html();n.html(MSG_LOADING),Foundation.utils.S(".tooltip").hide(),t.fadeTo(200,.33,function(){$.ajax({type:"POST",url:ABSOLUTE_URL+"/order_course_map_item_script",data:{plan:t.nestedSortable("serialize"),classe:a.item[0].className,idAttente:a.item[0].id},error:function(t,e,a){console.log(a),console.log(e)},complete:function(){n.html(MSG_LOADING_OK),t.fadeTo(200,1,function(){n.html(i),isRefreshing=!1})}})})}}}),t.find(".elemtitre.ui-sortable-handle").on("mouseup",function(){setLegendBarButtonsState()})}function _setTokenParams(){tokenParams={minChars:4,hintText:MSG_TOKEN_HINT_TEXT,searchingText:MSG_TOKEN_SEARCH_TEXT,noResultsText:MSG_TOKEN_EMPTY_TEXT,preventDuplicates:!0}}function setLDAPSearch(){_setTokenParams(),Foundation.utils.S("#input-groupe").tokenInput(ABSOLUTE_URL+"/rechercherUser",$.extend({},tokenParams,{queryParam:"groupe"}))}function setAuthorMod(){_setTokenParams(),Foundation.utils.S("#input-auteurs").tokenInput(ABSOLUTE_URL+"/rechercherUser",$.extend({},tokenParams,{queryParam:"coauteur",tokenLimit:1}))}function setCoAuthorReaderMod(){_setTokenParams(),Foundation.utils.S("#input-coauteurs").tokenInput(ABSOLUTE_URL+"/rechercherUser",$.extend({},tokenParams,{queryParam:"coauteur"}))}function setApogeeSearch(){Foundation.utils.S("#js-Apogee_search").submit(function(t){t.preventDefault();var e=$(this),a=Foundation.utils.S("#reveal-main");$.post(e.attr("action"),e.serialize()).done(function(t){a.empty().html(t),revealInit(a)})})}function setUESendMail(){Foundation.utils.S("#js-UESendMail").submit(function(t){t.preventDefault();var e=$(this),a=Foundation.utils.S("#reveal-etudiants");$.post(e.attr("action"),e.serialize()).done(function(t){var n=$.parseHTML(t);$(n).find(".fieldErrorBox").text()?(a.empty().html(t),revealInit(a)):(a.foundation("reveal","close"),setAlertBox("success",e.data("success_msg")))})})}function setWimsExportAccordionRadio(t){var e=Foundation.utils.S("#"+t),a=e.parent("form"),n=a.children(".formControls").children("[type=submit]");e.on("toggled",function(t,e){var a=$(this).find(".content.active").attr("id");void 0!==a?(switchButtonEnabledState(n,!0),Foundation.utils.S("#js-export_format").prop("value",a),Foundation.utils.S("#"+a+"_default").prop("checked",!0)):switchButtonEnabledState(n,!1)})}function closeDownloadModal(t){var e=Foundation.utils.S("#"+t);e.submit(function(t){Foundation.utils.S("#reveal-main").foundation("reveal","close"),setAlertBox("info",e.data("success_msg"))})}function setWimsGroupCreator(){$(document).on("open.fndtn.reveal","#group_create",function(){Foundation.utils.S("#groupPanelMessage").remove(),Foundation.utils.S("#noGroupPanelMessage").remove();var t=Foundation.utils.S("#js-wimsGroupCreator"),e,a="",n="",i=0,s=0;Foundation.utils.S('#js-update_target tbody input[name="paths:list"]:checked').each(function(o){$(this).data("no_group")?(n+="<li>"+$(this).data("res_name")+"</li>",s++):(e=$("<input>",{type:"hidden",value:$(this).val()}).attr("name","paths:list"),t.append(e),a+="<li>"+$(this).data("res_name")+"</li>",i++)}),i?(t.find(".field").show(),t.find('[type="submit"]').prop("disabled",!1).show(),s&&(n=s>1?t.data("p_no_msg")+"<ul>"+n+"</ul>":t.data("s_no_msg")+"<ul>"+n+"</ul>",t.prepend($("<div>",{id:"noGroupPanelMessage",class:"panel warning radius",html:n}))),a=i>1?t.data("p_yes_msg")+"<ul>"+a+"</ul>":t.data("s_yes_msg")+"<ul>"+a+"</ul>",t.prepend($("<div>",{id:"groupPanelMessage",class:"panel callout radius",html:a}))):(t.find(".field").hide(),t.find('[type="submit"]').prop("disabled",!0).hide(),n=t.data("all_no_msg"),n+=s>1?" "+t.data("p_all_no_msg"):" "+t.data("s_all_no_msg"),t.prepend($("<div>",{id:"groupPanelMessage",class:"panel warning radius",html:n})))})}function setQCMSuite(){function t(){var t=Foundation.utils.S(".question").length;input_nb_questions.val(t),t>=i/2&&n.fadeIn(),t>=i?a.fadeOut():a.fadeIn(),t<2?e.fadeOut():e.fadeIn()}var e=Foundation.utils.S("#supprimerQuestion"),a=Foundation.utils.S("#ajouterQuestion"),n=Foundation.utils.S("#js-max_questions_helper"),i=40;input_nb_questions=Foundation.utils.S("#nb_questions"),t(),a.on("click",function(){var e=Foundation.utils.S(".question"),a=e.length,n=Foundation.utils.S(e[0]),i=n.clone();i.find("input, textarea").each(function(){Foundation.utils.S(this).val("");var t=Foundation.utils.S(this).parent().attr("data-name")+a;Foundation.utils.S(this).attr("name",t),Foundation.utils.S(this).attr("id",t)}),i.find("label").each(function(){Foundation.utils.S(this).attr("for",Foundation.utils.S(this).parent().attr("data-name")+a)}),i.find("legend").each(function(){Foundation.utils.S(this).html(Foundation.utils.S(this).attr("data-titre")+(a+1))}),i.insertAfter(Foundation.utils.S(e[a-1])).hide().fadeIn("slow"),Foundation.utils.S("html, body").animate({scrollTop:i.offset().top},1e3),t()}),e.on("click",function(){var e=$.makeArray(Foundation.utils.S(".question")),a=Foundation.utils.S(e.pop()),n=Foundation.utils.S(e.pop());Foundation.utils.S("html, body").animate({scrollTop:n.offset().top},900),a.fadeOut("slow",function(){Foundation.utils.S(this).remove(),t()})})}function setRevealFormPlanRefresh(t,e){e=void 0!==e&&instantiateCKEditor(e),Foundation.utils.S("#"+t).submit(function(t){e&&CKEDITOR.instances[e].updateElement(),t.preventDefault();var a=$(this),n=a.parent(".reveal-modal"),i=Foundation.utils.S("#course_plan-plan");$.post(a.attr("action"),a.serialize()).done(function(t){"http"===t.split(":")[0]?$.get(t).done(function(t){if(i.html(t),i.children("li").length>1){var e=Foundation.utils.S("#course_plan .legend_bar");e.hasClass("hide")?(e.removeClass("hide"),Foundation.utils.S("#course_plan .course_help").removeClass("hide").addClass("show-for-medium-up")):setLegendBarButtonsState()}else Foundation.utils.S("#course_plan .legend_bar").addClass("hide"),Foundation.utils.S("#course_plan .course_help").removeClass("show-for-medium-up").addClass("hide");n.foundation("reveal","close"),setAlertBox("success",a.data("success_msg"))}):(n.empty().html(t),revealInit(n))})})}function setRevealForm(t,e){e=void 0!==e&&instantiateCKEditor(e),Foundation.utils.S("#"+t).submit(function(t){e&&CKEDITOR.instances[e].updateElement(),t.preventDefault();var a=$(this),n=a.parent(".reveal-modal"),i=a.find("#title");i.val($("<DIV>"+i.val()+"</DIV>").text()),$.post(a.attr("action"),a.serialize()).done(function(t){var e=$.parseHTML(t);$(e).find(".error").length?(n.empty().html(t),revealInit(n)):(Foundation.utils.S("#js-update_target").empty().html(t),n.foundation("reveal","close"),setAlertBox("success",a.data("success_msg_pre")+" \xab\xa0"+i.val()+"\xa0\xbb "+a.data("success_msg_post")))})})}function setPodFilterSelector(){var t=Foundation.utils.S("#js-podFilterSelector"),e=Foundation.utils.S("#term_search_label"),a=Foundation.utils.S("#term_search"),n=t.data("term_search_label1"),i=t.data("term_search_label2"),s=t.data("term_search_placeholder1"),o=t.data("term_search_placeholder2");Foundation.utils.S("#type_search").on("change",function(){"mes_videos"===$(this).val()?(e.text(i),a.attr("placeholder",o)):(e.text(n),a.attr("placeholder",s))})}function setPodContentMultipleSelection(){function t(t){return!(e.find('ul > li .switch > [type="checkbox"]:checked').length&&!confirm(s))||(t.preventDefault(),t.stopPropagation(),!1)}var e=Foundation.utils.S("#js-podContentsList"),a=e.find('[name="form.button.save"]'),n=Foundation.utils.S("#pagination-page_number"),i=n.find('[name="page"]'),s=n.data("page_change_msg1")+"\n"+n.data("page_change_msg2"),o=i.val();switchButtonEnabledState(a,!1),e.on("change",'ul > li .switch > [type="checkbox"]',function(){e.find('ul > li .switch > [type="checkbox"]:checked').length?switchButtonEnabledState(a,!0):switchButtonEnabledState(a,!1)}),Foundation.utils.S("#pagination-container").on("click","a.button",function(e){t(e)}),n.submit(function(e){t(e)||i.val(o)})}function setMailRegistrationForm(){function t(t){if(Boolean(t.trim().length)){var e=t.split(","),a,n;for(e=e.filter(function(t){return""!==t}),a=0,n=e.length;a<n;++a){if(e[a]=e[a].trim(),e[a].search(">")!==e[a].length-1)return!1;var i=e[a].replace(">","").split("<");if(2!==i.length)return!1;var o=new RegExp(s.find("input[name=lastname]").attr("pattern")),l=new RegExp(s.find("input[name=email]").attr("pattern"));if(!o.test(i[0])||!l.test(i[1]))return!1}return!0}return!1}var e=Foundation.utils.S("#js-mailRegistration"),a=e.children("fieldset"),n=e.find("button[type=submit]"),i=[],s=Foundation.utils.S("#js-mailRegistrationList"),o=s.find("input[name=lastname]"),l=Foundation.utils.S("#mailUserList"),u=s.find("tbody"),r="",d="",c="",p="",f="",m=!1;switchButtonEnabledState(n,!1),Foundation.utils.S("#js-modeSwitcher").on("click",function(t){s.is(":visible")?u.fadeOut("fast",function(){s.fadeOut("slow",function(){a.fadeIn("slow"),switchButtonEnabledState(n,!0),l.focus().attr("required","required")})}):a.fadeOut("slow",function(){s.fadeIn("slow",function(){u.fadeIn("fast",function(){u.find("tr").length?switchButtonEnabledState(n,!0):switchButtonEnabledState(n,!1),o.focus(),l.removeAttr("required")})})})}),e.submit(function(n){s.is(":visible")?(u.find("tr").each(function(t){i.push($(this).data("user_info"))}),l.val(i.join(", ")),revealFormOnSubmitBehavior(s)):t(l.val())?revealFormOnSubmitBehavior(e):(n.preventDefault(),a.find(".fieldErrorBox").html(MSG_FORM_VALIDATION_ERROR))}),s.submit(function(t){if(t.preventDefault(),c=s.find("input[name=firstname]").val().trim(),d=o.val().trim(),p=s.find("input[name=email]").val().trim(),m=!1,!c||!d||!p)return!1;f=c+" "+d+" <"+p+">",s.find("input").val(""),r='<tr class="hide" data-user_info="'+f+'">',r+='<td class="name">'+c+'</td><td class="name">'+d+'</td><td class="email">'+p+"</td><td>",r+='<a title="Retirer de la liste"><i class="fa fa-minus-circle fa-lg fa-fw no-pad warning"></i></a></td></tr>',u.find("tr").length?u.find("tr").each(function(){if($(this).data("user_info")===f||$(this).children("td.email").html()===p)return m=!0,!1}):s.find("div.panel:last-child").slideDown("slow",function(){switchButtonEnabledState(n,!0)}),m||($(r).appendTo(u).show("slow"),o.focus())}),u.on("click","a",function(t){t.preventDefault(),t.stopPropagation(),$(this).closest("tr").hide("slow",function(){$(this).remove(),u.find("tr").length||s.find("div.panel:last-child").slideUp("slow",function(){switchButtonEnabledState(n,!1)}),o.focus()})})}function switchButtonEnabledState(t,e){e?t.prop("disabled",!1):t.prop("disabled",!0)}function enableSubmitButtonIfCheckboxTicked(t){var e=Foundation.utils.S("#"+t).children(".formControls"),a=e.children("[type=submit]");e.find("[type=checkbox]").on("click",function(t){$(this).prop("checked")?switchButtonEnabledState(a,!0):switchButtonEnabledState(a,!1)})}function preventMultipleFormSubmits(t){Foundation.utils.S("#"+t).find("form").submit(function(t){$(this).find('[type="submit"]').prop("disabled",!0)})}function _setTagSelector(t){t.on("click","a.filter-button",function(t){t.preventDefault(),t.stopPropagation(),updateTagButtonState($(this))})}function updateTagButtonState(t){return t.hasClass("unselected")?(t.removeClass("unselected").addClass("selected").blur(),!0):t.hasClass("selected")?(t.removeClass("selected").addClass("unselected").blur(),!1):void 0}function setDateTimePicker(t){if(!Modernizr.inputtypes.datetime){var e=new Date,a=e.getFullYear();Foundation.utils.S("#"+t).datetimepicker({inline:!0,lang:"fr",format:"Y/m/d H:i",weeks:!1,minDate:0,step:15,yearStart:a,yearEnd:a+1,scrollMonth:!1,scrollYear:!1})}}function refreshWebconfList(){function t(){var t=Foundation.utils.S("#js-update_target"),e=Foundation.utils.S("#js-update_title"),a=e.html();e.html(MSG_LOADING),t.fadeTo(200,.33,function(){t.load(window.location.pathname,function(){t.fadeTo(200,1,function(){e.html(a)})})})}var e=Foundation.utils.S("#reveal-connect");Foundation.utils.S("#connect").on("click",function(t){e.foundation("reveal","open")}),e.find("a.button").on("click",function(a){e.foundation("reveal","close"),t()})}function refreshIframe(t,e,a){for(var n in a)"0"===n?document.getElementById(a[n]).classList.add("selected"):document.getElementById(a[n]).classList.remove("selected");$("#insert_wims").fadeOut(),document.getElementById(t).src=e,$("#insert_wims").fadeIn()}var tokenParams={};$.datetimepicker.setLocale("fr");