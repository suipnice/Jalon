<html xmlns="http://www.w3.org/1999/xhtml"
     xml:lang="en"
     lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="jalon.content">

<body>

<metal:main fill-slot="content"
            tal:define="external_resource_type context/getTypeRessourceExterne;
                        course_id request/course_id | nothing">

    <tal:condition condition="course_id">
        <tal:define define="no_return python:context.aq_parent.insererConsultation(user, course_id, external_resource_type.replace(' ', ''), context.getId())"/>
    </tal:condition>

    <h2>
        <tal:replace replace="context/Title"/>
        <a class="close-reveal-modal"></a>
    </h2>
    <tal:comment replace="nothing"><!--
    <div tal:condition="python:external_resource_type == 'Video'">
        <strong><tal:block i18n:translate="">Propriétaire :</tal:block></strong>
        <tal:block replace="context/getVideoauteurname"/>
    </div>
    --></tal:comment>
    <div class="panel radius"
         tal:condition="not:context/Description"
         i18n:translate="">
         Description non renseignée…
    </div>

    <div class="panel radius"
         tal:condition="context/Description"
         tal:content="structure python:context.Description().replace('\n', '<br/>')"></div>

    <tal:condition condition="python:external_resource_type == 'Catalogue BU'">
    <tal:define define="external_resource context/getRessourceCatalogueBU">
    <div id="js-primoContainer">
        <tal:block repeat="image_src external_resource/image">
            <img class="primo_img"
                 tal:condition="image_src"
                 tal:attributes="src image_src" />
        </tal:block>
    </div>

    <div class="panel radius">
        <strong>Éditeur :</strong>
        <tal:block replace="external_resource/publisher" />
        <tal:block content="external_resource/creationdate" />
    </div>

    <a class="button expand success" target="_blank"
       tal:condition="external_resource/urlcatalogue"
       tal:attributes="href external_resource/urlcatalogue">
        <i class="fa fa-eye"></i><tal:block i18n:translate="">Voir cette ressource sur le catalogue de la BU</tal:block>
    </a>

    <div class="panel warning radius"
         tal:condition="not:external_resource/urlcatalogue"
         i18n:translate="">
        La ressource n'est plus disponible dans le catalogue de la BU.
    </div>

    <script charset="UTF-8"
            tal:content="structure string:removeErrorImages('js-primoContainer')"></script>

    </tal:define>
    </tal:condition>

    <a class="button expand success" target="_blank"
       tal:attributes="href context/getURLLien"
       tal:condition="python:external_resource_type == 'Lien web'">
        <i class="fa fa-eye"></i><tal:block i18n:translate="">Ouvrir la ressource dans une nouvelle fenêtre…</tal:block>
    </a>

    <tal:condition condition="python:external_resource_type in ['Lecteur exportable', 'Video']">
    <div class="flex-video"
         tal:content="structure context/getLecteurExportable" />

    <script charset="UTF-8"
            tal:content="structure string:removePlayerOnClose()"></script>
    </tal:condition>

</metal:main>

</body>

</html>