<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="jalon.content">

<body>

<metal:main fill-slot="content"
            tal:define="tab request/tab | nothing;
                        mode_etudiant_request request/mode_etudiant | nothing;
                        my_view python:view.getWimsActivityView(user, mode_etudiant_request, tab, is_ajax);
                        mode_etudiant my_view/mode_etudiant">

<tal:condition condition="is_ajax">
    <tal:define define="no_return python:context.aq_parent.insererConsultation(user, my_view['activity_type'], context.getId())"/>
    <h2>
        <tal:replace replace="context/Title"
                     i18n:translate=""/>
        <a class="close-reveal-modal"></a>
    </h2>
    <h3 ><i class="fa fa-hand-paper-o"></i><span i18n:translate="">Consigne</span></h3>
    <div tal:attributes="class my_view/instruction_class"
         tal:content="structure my_view/instruction_text"
         i18n:translate=""/>
    <div class="text-center" tal:condition="python:my_view['activity_type']=='Examen'">
        <h3>
            <i class="fa fa-clock-o"></i>Durée : <span tal:content="my_view/duree"/> min.
        </h3>
    </div>
    <a class="button expand success"
       tal:attributes="href string:${my_view/activity_link}/view"
       tal:condition="not:my_view/is_anonymous">
        <i tal:attributes="class my_view/activity_icon"></i>
        <tal:block tal:content="my_view/activity_link_title"></tal:block>
    </a>
    <tal:condition condition="my_view/is_anonymous">
        <div class="panel radius warning text-center">
            <i class="fa fa-warning"></i>
            <strong i18n:translate="">Désolé, seul un utilisateur connecté peux participer aux activités d'un cours.</strong>
        </div>
        <a class="button expand"
           tal:define="page_quote python:context.jalon_quote(context.absolute_url())"
           tal:attributes="href string:${portal_url}/acl_users/credentials_cookie_auth/require_login?came_from=${page_quote}">
            <i class="fa fa-key"></i>
            <tal:block i18n:translate="">Se connecter pour accéder à cette activité WIMS</tal:block>
        </a>
    </tal:condition>
</tal:condition>

<tal:condition condition="not:is_ajax">


    <style type="text/css">
        /* texte informatif */
        .note_info{
            font-style: italic;
            font-size: .8rem;
        }
        /* nom de l'étudiant dans le listing des résultats */
        .nom_etudiant{
            font-size: 1rem;
        }
        /* rappel du style "sup" présent sur le plan du cours */
        .sup {
            position: absolute;
            top: 0;
            display: inline-block;
            background-color: #f04124;
            color: #fff;
            font-weight: 500;
            font-size: .75rem;
            margin-top: -.33em;
            vertical-align: top;
            padding: 2px .5em;
            text-shadow: none;
            border: 2px solid #fff;
            z-index: 10;
            border-radius: 1em;
            margin-left: .5em;
        }

        /* Dégradé 4+2 teintes (pour formatage conditionel des notes)*/
            /* score nul*/
            .zero_score{
                background-color: rgba(255, 99, 88, .5);
            }
            /* score inferieur à 25% */
            .firstQuarter{
                background-color: rgba(232,147, 69, .75);
            }
            /* score entre 25% et 50% */
            .secondQuarter{
                background-color: rgba(255,221, 88, .75);
            }
            /* score entre 50% et 75% */
            .thirdQuarter{
                background-color: rgba(188,232, 80, .75);
            }
            /* score superieur à 75% */
            .lastQuarter{
                background-color: rgba(88 ,255,126, .66);
            }
            /* score max */
            .max_score{
                background-color: rgba(114,173,255, .5);
            }

        @media only screen and (min-width: 40.063em) {
            /* Surcharge de styles "show-for-small-only" pour corriger un bug Foundation sur les TD/TH */
            td.show-for-small-only, th.show-for-small-only,
            td.hide-for-medium-up,  th.hide-for-medium-up{
                display:none !important
            }
        }

    </style>

    <tal:define define="no_return python:context.checkCourseAuthorized(user, request)"/>
    <tal:define define="no_return python:context.insererConsultation(user, 'Cours', '')"/>

    <tal:define define="breadcrumbs view/getBreadcrumbs">
    <metal:macro use-macro="context/breadcrumbs_macro/macros/breadcrumbs">
        Page d'affichage du fil d'ariane
    </metal:macro>
    </tal:define>

    <div id="reveal-main" class="reveal-modal medium"
         data-reveal="data-reveal" data-options="close_on_background_click: true;"></div>
    <div id="reveal-main_second" class="reveal-modal medium"
         data-reveal="data-reveal" data-options="close_on_background_click: true;"></div>
    <div id="reveal-main-large" class="reveal-modal large"
         data-reveal="data-reveal" data-options="close_on_background_click: true;"></div>

    <main class="row" role="main" aria-labelledby="page_title">

        <metal:macro use-macro="here/global_statusmessage_macro/macros/portal_message">
            Message de session
        </metal:macro>

        <div class="row"
             tal:define="message request/message | nothing"
             tal:condition="message">
            <metal:macro use-macro="context/macro_messages/macros/messages">
                encart d'affichage des messages de feedback
            </metal:macro>
        </div>

        <div class="small-12 columns text-center"
             tal:condition="my_view/is_anonymous">
            <div class="panel radius warning text-center">
                <i class="fa fa-warning"></i>
                <strong i18n:translate="">Désolé, seul un utilisateur connecté peux participer aux activités d'un cours.</strong>
            </div>
            <a tal:attributes="href my_view/came_from"
               class="showmore button">
               <i class="fa fa-key"></i>
               <tal:block i18n:translate="">Se connecter</tal:block>
            </a>
        </div>

        <tal:condition condition="not:my_view/is_anonymous">

        <section id="activity" class="medium-9 small-12 columns">
            <tal:condition condition="my_view/is_personnel">
            <a class="right" data-options="align:bottom" data-dropdown="activity-options">
                <i class="fa fa-cog fa-fw fa-lg no-pad"></i>
            </a>
            <ul id="activity-options" data-dropdown-content class="f-dropdown">
                <li tal:repeat="option my_view/wims_activity_edit">
                    <a tal:attributes="href option/href"
                       data-reveal-id="reveal-main" data-reveal-ajax="true">
                       <i tal:attributes="class string:fa ${option/icon} fa-fw"></i> <tal:block tal:content="option/text"
                                                                                                i18n:translate=""/>
                    </a>
                </li>
            </ul>
            </tal:condition>
            <h1>
                <i tal:attributes="class my_view/activity_icon"></i>
                <tal:replace replace="here/Title" />
            </h1>
            <div class="panel alert radius"
                 tal:condition="my_view/is_student_and_wims_activity_hidden">
                 <i class="fa fa-warning"></i><strong i18n:translate="">Attention :</strong> <tal:block i18n:translate="">cette activité est masquée, vous n'avez pas le droit d'y accéder.</tal:block>
            </div>
            <ul id="tab_button-group" class="button-group radius"
                tal:condition="my_view/is_personnel_or_wims_activity_visible">
                <li tal:repeat="onglet my_view/wims_activity_tabs">
                    <a tal:attributes="class string:button small${onglet/css_class};
                                       href onglet/href"
                       i18n:translate="">
                        <i tal:attributes="class string:fa ${onglet/icon}"></i><tal:block tal:content="onglet/text"
                                                                                          i18n:translate=""/>
                        <tal:on-error on-error="nothing">
                        <span class="sup" tal:content="onglet/nb"/>
                        </tal:on-error>
                    </a>
                </li>
            </ul>
            <tal:condition condition="my_view/is_personnel_or_wims_activity_visible">
                <metal:macro use-macro="python:context.course_activity_macro.macros.get('%s-list' % my_view['tab'])">
                    Page d'affichage de la liste des exos, documents ou resultats
                </metal:macro>
            </tal:condition>
        </section>

        <aside class="medium-3 small-12 columns">
            <tal:condition condition="my_view/is_display_mod">
            <metal:macro use-macro="context/course_life_macro/macros/display_mod">
                Mode Enseignant / Etudiant
            </metal:macro>
            </tal:condition>
            <div id="infos_activite" tal:condition="my_view/is_personnel_or_wims_activity_visible">
                <a tal:define="edit_link python:my_view['wims_activity_edit'][-1]"
                   tal:attributes="href edit_link/href; title edit_link/text"
                   tal:condition="my_view/is_personnel"
                   i18n:attributes="title"
                   data-reveal-id="reveal-main" data-reveal-ajax="true"
                   class="button radius tiny right">
                    <i tal:attributes="class string:fa ${edit_link/icon} fa-fw"></i> <tal:block tal:content="edit_link/text"
                                                                                                i18n:translate=""/>
                </a>
                <h2>
                    <i class="fa fa-info-circle"></i><tal:block  i18n:translate="">Instructions</tal:block>
                </h2>
                <div class="panel bkgrnd radius">
                    <metal:macro use-macro="context/wims_activity_macro/macros/informations">Affiche les informations de l'activité</metal:macro>
                </div>
            </div>
        </tal:condition>
    </main>

</tal:condition>

</metal:main>

</body>

</html>