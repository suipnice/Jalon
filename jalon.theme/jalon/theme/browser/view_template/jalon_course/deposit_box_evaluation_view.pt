<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="jalon.content">

<body>

<metal:main fill-slot="content"
            tal:define="my_view python:view.getStudentEvaluationView(user.getId())">

    <tal:define define="breadcrumbs view/getBreadcrumbs">
    <metal:macro use-macro="context/breadcrumbs_macro/macros/breadcrumbs">
        Page d'affichage du fil d'ariane
    </metal:macro>
    </tal:define>

    <main class="row" role="main" aria-labelledby="page_title">
        <section>
        <h1>
            <tal:condition condition="my_view/acces_evaluations">
            <i class="fa fa-users"></i>Mon évaluation (<tal:replace replace="my_view/evaluation_note"/> / 20)
            </tal:condition>
            <tal:condition condition="my_view/has_self_evaluation">
            <i class="fa fa-user"></i>Mon auto-évaluation (<tal:replace replace="my_view/self_evaluation_note"/> / 20)
            </tal:condition>
        </h1>

        <div class="panel warning radius">
            <strong>Attention :</strong> Cette fonction est actuellement en phase de test merci de remonter vos difficultés d'utilisation.
        </div>

        <div class="panel callout radius"
             tal:condition="not:my_view/has_evaluation">
            Vous n'avez pas encore été évalué.
        </div>

        <tal:condition condition="my_view/has_evaluation">
        <ul class="tabs" data-tab role="tablist">
            <tal:repeat repeat="index my_view/criteria_order">
            <li class="tab-title" role="presentation">
                <a role="tab" tabindex="0" aria-selected="true"
                   tal:attributes="href string:#criteria${repeat/index/number};
                                   aria-controls string:#criteria${repeat/index/number}"
                   tal:content="string:Critère ${repeat/index/number}"/>
            </li>
            </tal:repeat>
        </ul>

        <div class="tabs-content peer_evaluate">
            <section role="tabpanel" aria-hidden="true" class="content active">
                <div class="panel callout radius">Sélectionnez un onglet</div>
            </section>

            <tal:repeat repeat="index my_view/criteria_order">
            <section role="tabpanel" aria-hidden="true" class="content"
                     tal:define="criteria python:my_view['criteria_dict'][index];
                                 criteria_id string:criteria${repeat/index/number};"
                     tal:attributes="id criteria_id">
                <h2>
                    <tal:replace replace="criteria/title"/>
                </h2>
                <div class="row">
                    <div class="small-12 columns">
                        <h3>Description :</h3>
                    </div>
                    <div class="small-12 medium-7 columns">
                        <div class="panel callout radius"
                             tal:content="structure python:criteria['description'].replace('\n', '<br/>')"/>
                    </div>
                    <div class="small-12 medium-5 columns">
                        <dl class="deflist">
                            <dt>Coefficient</dt>
                            <dd tal:content="criteria/coefficient" />
                            <dt>Commentaire étudiant</dt>
                            <dd>
                                <tal:replace replace="python:my_view['comment_dict'][criteria['comment']]"/>,
                            </dd>
                            <dd>
                                entre <tal:replace replace="criteria/comment_min"/> et <tal:replace replace="criteria/comment_max"/> caractères.
                            </dd>
                        </dl>
                    </div>
                </div>
                <div tal:condition="my_view/has_self_evaluation">
                    <h3>
                        Mon auto-évaluation de ce critère (<tal:replace replace="python:my_view['self_evaluation_dict'][index]['criteria_note']"/> / <tal:replace replace="criteria/notation"/> points)
                    </h3>
                    <div class="panel callout radius"
                         tal:define="comment python:my_view['self_evaluation_dict'][index]['criteria_comment']"
                         tal:content="comment"
                         tal:condition="comment"/>
                </div>
                <tal:condition condition="my_view/acces_evaluations">
                <tal:define define="criteria_list python:my_view['peer_evaluation'].get(index, [])">
                <div tal:repeat="criteria_dict criteria_list">
                    <h3>
                        Évaluation numéro <tal:replace replace="repeat/criteria_dict/number"/> (<tal:replace replace="criteria_dict/criteria_note"/> / <tal:replace replace="criteria/notation"/> points)
                    </h3>
                    <div class="panel callout radius"
                         tal:content="criteria_dict/criteria_comment"
                         tal:condition="criteria_dict/criteria_comment"/>
                </div>
                <div tal:define="average_dict python:my_view['peer_average'][index]">
                    <tal:condition condition="python:average_dict['criteria_note_t']">
                    <h2>
                        Évaluation de l'enseignant (<tal:replace replace="average_dict/criteria_note"/>  / <tal:replace replace="criteria/notation"/> points)
                    </h2>
                    <div class="panel callout radius"
                         tal:content="average_dict/criteria_comment"
                         tal:condition="average_dict/criteria_comment"/>
                    </tal:condition>
                    <h2>
                        Note du critère : <tal:replace replace="average_dict/criteria_note"/> / <tal:replace replace="criteria/notation"/> points
                    </h2>
                </div>
                </tal:define>
                </tal:condition>
            </section>
            </tal:repeat>
        </div>
        </tal:condition>
        </section>
    </main>
</metal:main>

</body>

</html>