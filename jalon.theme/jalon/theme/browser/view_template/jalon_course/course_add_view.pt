<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="jalon.content">

<body>

<metal:main fill-slot="content"
            tal:define="course_path request/course_path;
                        my_view python:view.getCourseAddView(user, course_path)">

    <h2>
        <i class="fa fa-plus-circle"></i>
        <tal:block i18n:translate="">Ajouter des éléments au cours</tal:block>
        <a class="close-reveal-modal"></a>
    </h2>

    <div class="row">
        <ul class="tabs" data-tab role="tablist">
            <li role="presentation"
                class="tab-title active">
                <a role="tab" tabindex="0" aria-selected="true"
                   id="resources_list";
                   href="#resources_list";
                   aria-controls="#resources_list">
                    <i class="fa fa-folder-open"></i>
                    <tal:block i18n:translate="">Depuis mes ressources</tal:block>
                </a>
            </li>
            <li role="presentation"
                class="tab-title">
                <a role="tab" tabindex="1" aria-selected="false"
                   id="resources_new";
                   href="#resources_new";
                   aria-controls="#resources_new">
                    <i class="fa fa-plus-circle"></i>
                    <tal:block i18n:translate="">Nouvelle ressource</tal:block>
                </a>
            </li>
        </ul>

        <div class="tabs-content peer_evaluate">
            <section role="tabpanel" aria-hidden="false"
                     id="resources_list"
                     class="content active">
                <h2>
                    <i class="fa fa-plus-circle"></i>
                    <tal:block i18n:translate="">Attacher un élément de « Mes ressources »</tal:block>
                </h2>

                <h3 class="texte_icone icone_tags" i18n:translate="">Étiquettes</h3>

                <ul id="js-tag_filter"
                    tal:define="tags_list my_view/tags_list">
                    <metal:macro use-macro="context/my_space_tags_macro/macros/tags_list" />
                </ul>

                <div id="js-list-ressource">
                    <h3 id="js-popup-update_title">
                        <i tal:attributes="class my_view/course_add_list_icon"></i><tal:replace replace="context/Title" i18n:translate=""/>
                    </h3>

                    <form id="js-attachmentCreator" method="POST"
                          tal:attributes="action string:${my_view/course_link}/add_course_my_space_items_script"
                          data-success_msg="Élément(s) ajouté(s) au plan du cours.">
                        <div id="js-popup-update_target"
                             tal:attributes="data-href string:${context/absolute_url}/course_add_view_ajax?course_path=${course_path}">
                            <metal:macro use-macro="python:getattr(context, my_view['macro_file']).macros['add_course_items']" />
                        </div>

                        <tal:items condition="not:my_view/is_no_items">
                            <tal:condition condition="my_view/is_course">
                            <tal:replace replace="structure my_view/course_map_form"/>
                            </tal:condition>

                            <div class="field"
                                 tal:condition="my_view/is_display_hide">
                                <h3><i class="fa fa-eye"></i><tal:block i18n:translate="">Disponibilité</tal:block></h3>
                                <tal:define define="attacher_afficher request/attacher_afficher | string:0;">
                                <input type="radio" name="display_item" id="attacher_afficher"
                                       value="1"
                                       tal:attributes="checked python:context.test(int(attacher_afficher), 'checked', '')" />
                                <label for="attacher_afficher" i18n:translate="">Afficher immédiatement</label>
                                <input type="radio" name="display_item" id="attacher_masquer"
                                       value="0"
                                       tal:attributes="checked python:context.test(int(attacher_afficher), '', 'checked')" />
                                <label for="attacher_masquer" i18n:translate="">Masquer</label>
                                </tal:define>
                            </div>

                            <input type="hidden" name="user_id" tal:attributes="value user/getId"/>
                            <input type="hidden" name="folder_id" tal:attributes="value my_view/folder_id"/>

                            <div class="formControls">
                                <button type="submit" name="attacher"
                                        class="button small radius" disabled="disabled">
                                    <i class="fa fa-chain"></i>
                                    <tal:block i18n:translate="">Attacher</tal:block>
                                </button>
                            </div>
                        </tal:items>
                    </form>

                    <!--
                    <script charset="UTF-8"
                            tal:condition="python:context.test(context.getId() in ['mes_fichiers', 'mes_presentations_sonorisees', 'mes_ressources_externes', 'mes_webconferences', 'mes_videos_pod'], 1, 0)">setAttachmentCreator()</script>
                    <script charset="UTF-8"
                            tal:condition="python:context.test(context.getId() in ['mes_termes_glossaire', 'mes_exercices_wims', 'course_bibliography'], 1, 0)">setTagFilter(true)</script>
                    -->

                    <script charset="UTF-8"
                            tal:content="my_view/course_add_js"></script>
                </div>
            </section>

            <section role="tabpanel" aria-hidden="true"
                     id="resources_new"
                     class="content">
                <metal:macro use-macro="python:getattr(context, my_view['macro_file']).macros['add_new_resource']" />
            </section>
        </div>
    </div>
</metal:main>

</body>

</html>