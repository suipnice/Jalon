<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr-FR" lang="fr"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="jalon.theme">
<body>
    <metal:main fill-slot="content">

    <metal:macro define-macro="add_tags_objects">
        <!-- L'attribut data-options permet d'éviter un bug à la fermeture du popup dans certaines conditions non vraiment définies… -->
        <div id="tag_sel" class="reveal-modal medium"
             data-reveal="data-reveal" data-options="close_on_background_click: true;"
             tal:define="is_tags python:context.test(len(my_view['tags_list']) > 1, 1, 0)">
            <h2>
                <tal:block i18n:translate="head_tag_all_selected">Étiqueter l'ensemble des ressources sélectionnées</tal:block>
                <a class="close-reveal-modal"></a>
            </h2>
            <div class="panel callout radius"
                 tal:condition="not:is_tags"
                 i18n:translate="">
                Il n'y a actuellement aucune étiquette de crée. Pour créer une étiquette cliquez sur le "+" en bout de la ligne des étiquettes.
            </div>
            <form method="POST"
                  tal:attributes="action string:${context/absolute_url}/add_tags_objects_script;
                                  data-success_msg string:L'ensemble sélectionné a été étiqueté.;
                                  data-s_tag_msg string:Choisissez une ou plusieurs étiquettes à associer à la ressource sélectionnée :;
                                  data-p_tag_msg string:Choisissez une ou plusieurs étiquettes à associer aux ressources sélectionnées :"
                  tal:condition="is_tags"
                  i18n:attributes="data-success_msg; data-s_tag_msg; data-p_tag_msg">

                <ul>
                    <li tal:repeat="tag my_view/tags_list">
                        <a class="filter-button unselected"
                           tal:attributes="id tag/tag_id"
                           tal:condition="repeat/tag/index">
                            <i class="fa fa-circle no-pad"></i>
                            <i class="fa fa-circle-thin no-pad"></i>
                            <tal:block tal:content="tag/tag_title" />
                        </a>
                    </li>
                </ul>

                <!--input type="hidden" name="lots" value="lots" /-->
                <div class="formControls">
                    <button type="submit" class="button small radius"
                            name="etiqueter_script:method">
                        <i class="fa fa-tag"></i>
                        <tal:block i18n:translate="button_tagging">Étiqueter</tal:block>
                    </button>
                </div>
            </form>
        </div>
    </metal:macro>


    <metal:macro define-macro="isnt_selected_tags">

        <div id="untag_sel" class="reveal-modal medium"
             data-reveal="data-reveal" data-options="close_on_background_click: true;">
            <h2>
                <tal:block i18n:translate="">Désétiqueter l'ensemble des ressources sélectionnées</tal:block>
                <a class="close-reveal-modal"></a>
            </h2>

            <div class="panel radius callout">
                Vous devez au minimum sélectionner une étiquette pour pouvoir désétiqueter.
            </div>
        </div>
    </metal:macro>


    <metal:macro define-macro="remove_tags_objects">
        <!-- L'attribut data-options permet d'éviter un bug à la fermeture du popup dans certaines conditions non vraiment définies… -->
        <div id="untag_sel" class="reveal-modal medium"
             data-reveal="data-reveal" data-options="close_on_background_click: true;">
            <h2>
                <tal:block i18n:translate="">Désétiqueter l'ensemble des ressources sélectionnées</tal:block>
                <a class="close-reveal-modal"></a>
            </h2>

            <form method="POST"
                  tal:attributes="action string:${context/absolute_url}/remove_tags_objects_script;
                                  data-success_msg string:Le désétiquetage demandé a été effectué.;
                                  data-untag_msg string:L'ensemble des étiquettes actives :;
                                  data-s_untag_msg string:… ne sera plus associé à la ressource sélectionnée :;
                                  data-p_untag_msg string:… ne sera plus associé aux ressources sélectionnées :"
                  i18n:attributes="data-success_msg; data-untag_msg; data-s_untag_msg; data-p_untag_msg">
                <div class="formControls">
                    <button type="submit" class="button small warning radius"
                            name="desetiqueter_script:method">
                        <i class="fa fa-minus-circle"></i>
                        <tal:block i18n:translate="">Désétiqueter</tal:block>
                    </button>
                </div>
            </form>
        </div>
    </metal:macro>


    <metal:macro define-macro="delete_objects">
        <!-- L'attribut data-options permet d'éviter un bug à la fermeture du popup dans certaines conditions non vraiment définies… -->
        <div id="del_sel" class="reveal-modal medium"
             data-reveal="data-reveal" data-options="close_on_background_click: true;">
            <h2>
                <tal:block i18n:translate="">Supprimer l'ensemble des ressources sélectionnées</tal:block>
                <a class="close-reveal-modal"></a>
            </h2>

            <form method="POST"
                  tal:attributes="action string:${my_view/folder_link}/delete_object_script;
                                  data-success_msg string:La suppression demandée a été effectuée.;
                                  data-all_att_msg string:Suppression impossible :;
                                  data-s_all_att_msg string:la ressource sélectionnée est attachée à un ou plusieurs cours.;
                                  data-p_all_att_msg string:les ressources sélectionnées sont attachées à un ou plusieurs éléments (cours, activité ou groupe d'exercices WIMS).;
                                  data-s_supp_msg string:La ressource suivante va être supprimée :;
                                  data-p_supp_msg string:Les ressources suivantes vont être supprimées :;
                                  data-s_att_msg string:La ressource suivante, attachée à un ou plusieurs cours, ne sera pas supprimée :;
                                  data-p_att_msg string:Les ressources suivantes, attachées à un ou plusieurs cours, ne seront pas supprimées :"
                  i18n:attributes="data-success_msg; data-all_att_msg; data-s_all_att_msg; data-p_all_att_msg; data-s_supp_msg; data-s_att_msg; data-p_supp_msg; data-p_att_msg">
                <div class="panel alert radius"
                     i18n:translate="">
                    <strong i18n:translate="msg_warning">Attention :</strong>
                    <tal:block i18n:translate="">cette opération est définitive.</tal:block>
                </div>
                <input type="hidden" name="orig_template" tal:attributes="value context/absolute_url"/>
                <input tal:replace="structure context/@@authenticator/authenticator" />
                <div class="formControls">
                    <button type="submit" class="button small alert radius">
                        <i class="fa fa-trash-o"></i>
                        <tal:block i18n:translate="">Supprimer</tal:block>
                    </button>
                </div>
            </form>
        </div>
    </metal:macro>

    <!--
            Créer un groupe d'exercices Wims (série, ou selection aléatoire)
    -->
    <metal:macro define-macro="create_wims_exercice_group">

        <!-- L'attribut data-options permet d'éviter un bug à la fermeture du popup dans certaines conditions non vraiment définies… -->
        <div id="group_create" class="reveal-modal medium"
             data-reveal="data-reveal" data-options="close_on_background_click: true;">

            <h2>
                <tal:block i18n:translate="">Créer un groupe d'exercices</tal:block>
                <a class="close-reveal-modal"></a>
            </h2>

            <form id="js-wimsGroupCreator" method="POST"
                  tal:attributes="action string:${context/absolute_url};
                                  data-success_msg string:Le groupe d'exercices Wims a été crée.;
                                  data-all_no_msg string:Création de groupe impossible :;
                                  data-s_all_no_msg string:l'exercice sélectionné est un groupe ou un exercice externe.;
                                  data-p_all_no_msg string:les exercices sélectionnés sont des groupes ou des exercices externes.;
                                  data-s_yes_msg string:L'exercice suivant fera partie du groupe :;
                                  data-p_yes_msg string:Les exercices suivants feront partie du groupe :;
                                  data-s_no_msg string:L'exercice suivant est un groupe ou un exercice externe, et ne peut pas être inclus dans un groupe :;
                                  data-p_no_msg string:Les exercices suivants sont des groupes ou des exercices externes, et ne peuvent pas être inclus dans un groupe :"
                  i18n:attributes="data-success_msg; data-all_no_msg; data-s_all_no_msg; data-p_all_no_msg; data-s_yes_msg; data-s_no_msg; data-p_yes_msg; data-p_no_msg">

                <div id="archetypes-fieldname-title" class="field ArchetypesStringWidget">
                    <label for="title" class="formQuestion">
                        Titre du groupe d'exercices
                        <span id="title_wims_help" class="formHelp">
                            <tal:block i18n:translate="">Un titre de groupe, comme un titre d'exercice, est limité à 40 caractères.</tal:block><br />
                            <tal:block i18n:translate="">Attention : les caractères spéciaux</tal:block> (&lt; " &gt; { } ( ) $ &amp; …)
                            <tal:block i18n:translate="">sont interdits.</tal:block>
                        </span>
                    </label>
                    <div class="fieldErrorBox"></div>
                    <input type="text" maxlength="40"
                           id="title" name="title"
                           required="required" placeholder="Saisie obligatoire"
                           i18n:attributes="placeholder" />
                </div>

                <div id="archetypes-fieldname-qnum" class="field ArchetypesStringWidget">
                    <label for="qnum" class="formQuestion" i18n:translate="">
                        Nombre d'exercices de ce groupe auxquels l'étudiant devra répondre
                    </label>
                    <span class="formHelp">Une note ne sera attribuée qu'une fois la totalité des exercices terminés.</span>
                    <div class="fieldErrorBox"></div>
                    <select name="qnum" id="qnum">
                <tal:block repeat="val python:range(1,10)">
                        <option tal:attributes="value val" tal:content="val" />
                </tal:block>
                    </select>
                </div>

                <input type="hidden" name="authMember" tal:attributes="value user/getId" />
                <input type="hidden" name="modele" value="groupe" />
                <input type="hidden" name="macro" value="ajout-groupe-wims" />
                <input type="hidden" name="form.submitted" value="1" />

                <input type="hidden" name="create_wims_exercice_group_script:method" value="Save" />

                <div class="formControls">
                    <button type="submit" class="button small create radius"
                            name="create_wims_exercice_group_script:method">
                        <i class="fa fa-check-circle"></i>
                        <tal:block i18n:translate="">Créer le groupe</tal:block>
                    </button>
                </div>

            </form>
        </div>
    </metal:macro>

    <!--
            Exporter une selection d'exercices Wims
            (TODO : il faudrait reprendre une partie de export_wims_exercice_form)
    -->
    <metal:macro define-macro="export_wims_exercices">

        <!-- L'attribut data-options permet d'éviter un bug à la fermeture du popup dans certaines conditions non vraiment définies… -->
        <div id="export_wims_sel" class="reveal-modal medium"
             data-reveal="data-reveal" data-options="close_on_background_click: true;">

            <h2>
                <tal:block i18n:translate="">Exporter les exercices selectionnés</tal:block>
                <a class="close-reveal-modal"></a>
            </h2>

            <form id="js-wimsExporter" method="POST"
                  tal:attributes="action string:${context/absolute_url};
                                  data-success_msg string:Génération du fichier d'export en cours…;
                                  data-all_no_msg string:Création d'un export impossible :;
                                  data-s_all_no_msg string:le modèle de l'exercice sélectionné n'est pas exportable pour le moment.;
                                  data-p_all_no_msg string:les modèles des exercices sélectionnés ne sont pas exportables pour le moment.;
                                  data-s_yes_msg string:L'exercice suivant fera partie de l'export :;
                                  data-p_yes_msg string:Les exercices suivants feront partie de l'export :;
                                  data-s_no_msg string:L'exercice suivant ne peut pas (encore) être exporté :;
                                  data-p_no_msg string:Les exercices suivants ne peuvent pas (encore) être exportés :"
                  i18n:attributes="data-success_msg; data-all_no_msg; data-s_all_no_msg; data-p_all_no_msg; data-s_yes_msg; data-s_no_msg; data-p_yes_msg; data-p_no_msg">

                <div class="field">
                    <h3 i18n:translate="">Choisissez un format d'export :</h3>
                    <dl id="js-accordion_export-WIMS" class="accordion"
                        data-accordion="export-WIMS" role="tablist">

                        <!--dd class="accordion-navigation">
                            <a href="#export_WIMS" role="tab" id="export_WIMS_heading"><tal:block i18n:translate="">Format WIMS</tal:block></a>
                            <div id="export_WIMS" class="content" role="tabpanel" aria-labelledby="export_WIMS_heading">
                                <ul>
                                    <li>
                                        <input type="radio" id="OEF" value="oef" name="type" disabled="disabled" />
                                        <label for="OEF"><del i18n:translate="">Format OEF</del></label>
                                        <span class="label secondary" i18n:translate="">Format natif de WIMS. </span>
                                        <p class="formHelp texte_icone icone_information" i18n:translate=""> Ce format sera bientôt disponible. Revenez nous voir plus tard ;).</p>
                                    </li>
                                </ul>
                            </div>
                        </dd-->

                        <dd class="accordion-navigation">
                        <a href="#export_Moodle" role="tab" id="export_Moodle_heading"><tal:block i18n:translate="">Format Moodle</tal:block> <span class="label" i18n:translate="">Vous permet d'importer vos exercices dans Moodle</span></a>
                            <div id="export_Moodle" class="content active" role="tabpanel" aria-labelledby="export_Moodle_heading">
                                <ul>
                                    <li>
                                        <input type="radio" id="MoodleXML" value="MoodleXML" name="type" checked="checked"/>
                                        <label for="MoodleXML">
                                            Moodle XML
                                            <span class="label secondary" i18n:translate="">Pour le moment, le format "Moodle XML" est disponible pour certains modèles d'exercices uniquement.</span>
                                        </label>
                                    </li>
                                </ul>
                                <div class="formHelp texte_icone icone_information" i18n:translate=""> Pour éviter des traitements trop longs, évitez d'exporter plus de 20 exercices à la fois.</div>
                                <div class="formHelp texte_icone icone_information" i18n:translate=""> Les étiquettes de vos exercices deviendront des catégories de questions, mais attention : Moodle ne permet qu'une catégorie par question.</div>
                            </div>
                        </dd>
                    </dl>
                </div>

                <input type="hidden" name="authMember" tal:attributes="value user/getId" />
                <input type="hidden" name="form.submitted" value="1" />

                <input type="hidden" name="export_wims_exercices_script:method" />

                <div class="formControls">
                    <button type="submit" class="button small create radius"
                            name="export_wims_exercices_script:method">
                        <i class="fa fa-download"></i>
                        <tal:block i18n:translate="">Télécharger</tal:block>
                    </button>
                </div>

            </form>
            <div class="panel">
                <div i18n:translate="msg_export_WIMS_in_beta">L'export d'exercices multiples est une fonctionalité expérimentale actuellement en phase "Bêta".</div>
                <div i18n:translate="msg_export_WIMS_check">Assurez-vous de vérifier qu'il n'y a pas eu de souci lors de l'import, et n'hésitez-pas à nous faire des retours sur cette fonctionalité !</div>
                <div i18n:translate="">nb : Vous trouverez plus de formats disponibles via l'export d'un exercice individuel.</div>
            </div>
        </div>
    </metal:macro>

</metal:main>

</body>

</html>