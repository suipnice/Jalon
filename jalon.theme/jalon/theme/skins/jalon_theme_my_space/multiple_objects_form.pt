<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="jalon.content">

<body>
    <metal:main fill-slot="content">

    <metal:macro define-macro="add_tags_objects">
        <!-- L'attribut data-options permet d'éviter un bug à la fermeture du popup dans certaines conditions non vraiment définies… -->
        <div id="tag_sel" class="reveal-modal medium"
             data-reveal="data-reveal" data-options="close_on_background_click: true;"
             tal:define="is_tags python:context.test(len(my_view['tags_list']) > 1, 1, 0)">
            <h2>
                <tal:block i18n:translate="">Étiqueter l'ensemble des ressources sélectionnées</tal:block>
                <a class="close-reveal-modal"></a>
            </h2>
            <div class="panel callout radius"
                 tal:condition="not:is_tags"
                 i18n:translate="">
                Il n'y a actuellement aucune étiquette de crée. Pour créer une étiquette cliquez sur le "+" en bout de la ligne des étiquettes.
            </div>
            <form method="POST"
                  tal:attributes="action string:${context/absolute_url}/add_tags_objects_script;
                                  data-success_msg string:L'ensemble sélectionné a été étiqueté.;
                                  data-s_tag_msg string:Choisissez une ou plusieurs étiquettes à associer à la ressource sélectionnée :;
                                  data-p_tag_msg string:Choisissez une ou plusieurs étiquettes à associer aux ressources sélectionnées :"
                  tal:condition="is_tags"
                  i18n:attributes="data-success_msg; data-s_tag_msg; data-p_tag_msg">

                <ul>
                    <li tal:repeat="tag my_view/tags_list">
                        <a class="filter-button unselected"
                           tal:attributes="id tag/tag_id"
                           tal:condition="repeat/tag/index">
                            <i class="fa fa-circle no-pad"></i>
                            <i class="fa fa-circle-thin no-pad"></i>
                            <tal:block tal:content="tag/tag_title" />
                        </a>
                    </li>
                </ul>

                <!--input type="hidden" name="lots" value="lots" /-->
                <div class="formControls">
                    <button type="submit" class="button small radius"
                            name="etiqueter_script:method">
                        <i class="fa fa-tag"></i>
                        <tal:block i18n:translate="">Étiqueter</tal:block>
                    </button>
                </div>
            </form>
        </div>
    </metal:macro>


    <metal:macro define-macro="isnt_selected_tags">

        <div id="untag_sel" class="reveal-modal medium"
             data-reveal="data-reveal" data-options="close_on_background_click: true;">
            <h2>
                <tal:block i18n:translate="">Désétiqueter l'ensemble des ressources sélectionnées</tal:block>
                <a class="close-reveal-modal"></a>
            </h2>

            <div class="panel radius callout">
                Vous devez au minimum sélectionner une étiquette pour pouvoir désétiqueter.
            </div>
        </div>
    </metal:macro>


    <metal:macro define-macro="remove_tags_objects">
        <!-- L'attribut data-options permet d'éviter un bug à la fermeture du popup dans certaines conditions non vraiment définies… -->
        <div id="untag_sel" class="reveal-modal medium"
             data-reveal="data-reveal" data-options="close_on_background_click: true;">
            <h2>
                <tal:block i18n:translate="">Désétiqueter l'ensemble des ressources sélectionnées</tal:block>
                <a class="close-reveal-modal"></a>
            </h2>

            <form method="POST"
                  tal:attributes="action string:${context/absolute_url}/remove_tags_objects_script;
                                  data-success_msg string:Le désétiquetage demandé a été effectué.;
                                  data-untag_msg string:L'ensemble des étiquettes actives :;
                                  data-s_untag_msg string:… ne sera plus associé à la ressource sélectionnée :;
                                  data-p_untag_msg string:… ne sera plus associé aux ressources sélectionnées :"
                  i18n:attributes="data-success_msg; data-untag_msg; data-s_untag_msg; data-p_untag_msg">
                <div class="formControls">
                    <button type="submit" class="button small warning radius"
                            name="desetiqueter_script:method">
                        <i class="fa fa-minus-circle"></i>
                        <tal:block i18n:translate="">Désétiqueter</tal:block>
                    </button>
                </div>
            </form>
        </div>
    </metal:macro>


    <metal:macro define-macro="delete_objects">
        <!-- L'attribut data-options permet d'éviter un bug à la fermeture du popup dans certaines conditions non vraiment définies… -->
        <div id="del_sel" class="reveal-modal medium"
             data-reveal="data-reveal" data-options="close_on_background_click: true;">
            <h2>
                <tal:block i18n:translate="">Supprimer l'ensemble des ressources sélectionnées</tal:block>
                <a class="close-reveal-modal"></a>
            </h2>

            <form method="POST"
                  tal:attributes="action string:${my_view/folder_link}/delete_object_script;
                                  data-success_msg string:La suppression demandée a été effectuée.;
                                  data-all_att_msg string:Suppression impossible :;
                                  data-s_all_att_msg string:la ressource sélectionnée est attachée à un ou plusieurs cours.;
                                  data-p_all_att_msg string:les ressources sélectionnées sont attachées à un ou plusieurs éléments (cours, activité ou groupe d'exercices WIMS).;
                                  data-s_supp_msg string:La ressource suivante va être supprimée :;
                                  data-p_supp_msg string:Les ressources suivantes vont être supprimées :;
                                  data-s_att_msg string:La ressource suivante, attachée à un ou plusieurs cours, ne sera pas supprimée :;
                                  data-p_att_msg string:Les ressources suivantes, attachées à un ou plusieurs cours, ne seront pas supprimées :"
                  i18n:attributes="data-success_msg; data-all_att_msg; data-s_all_att_msg; data-p_all_att_msg; data-s_supp_msg; data-s_att_msg; data-p_supp_msg; data-p_att_msg">
                <div class="panel alert radius"
                     i18n:translate="">
                    <strong i18n:translate="">Attention :</strong>
                    <tal:block i18n:translate="">cette opération est définitive.</tal:block>
                </div>
                <input type="hidden" name="orig_template" tal:attributes="value context/absolute_url"/>
                <input tal:replace="structure context/@@authenticator/authenticator" />
                <div class="formControls">
                    <button type="submit" class="button small alert radius">
                        <i class="fa fa-trash-o"></i>
                        <tal:block i18n:translate="">Supprimer</tal:block>
                    </button>
                </div>
            </form>
        </div>
    </metal:macro>

    <!--
            Créer un groupe d'exercices Wims (série, ou selection aléatoire)
    -->
    <metal:macro define-macro="create_wims_exercice_group">

        <!-- L'attribut data-options permet d'éviter un bug à la fermeture du popup dans certaines conditions non vraiment définies… -->
        <div id="group_create" class="reveal-modal medium"
             data-reveal="data-reveal" data-options="close_on_background_click: true;">

            <h2>
                <tal:block i18n:translate="">Créer un groupe d'exercices</tal:block>
                <a class="close-reveal-modal"></a>
            </h2>

            <form id="js-wimsGroupCreator" method="POST"
                  tal:attributes="action string:${context/absolute_url};
                                  data-success_msg string:Le groupe d'exercices Wims a été crée.;
                                  data-all_no_msg string:Création de groupe impossible :;
                                  data-s_all_no_msg string:l'exercice sélectionné est un groupe ou un exercice externe.;
                                  data-p_all_no_msg string:les exercices sélectionnés sont des groupes ou des exercices externes.;
                                  data-s_yes_msg string:L'exercice suivant fera partie du groupe :;
                                  data-p_yes_msg string:Les exercices suivants feront partie du groupe :;
                                  data-s_no_msg string:L'exercice suivant est un groupe ou un exercice externe, et ne peut pas être inclus dans un groupe :;
                                  data-p_no_msg string:Les exercices suivants sont des groupes ou des exercices externes, et ne peuvent pas être inclus dans un groupe :"
                  i18n:attributes="data-success_msg; data-all_no_msg; data-s_all_no_msg; data-p_all_no_msg; data-s_yes_msg; data-s_no_msg; data-p_yes_msg; data-p_no_msg">

                <div id="archetypes-fieldname-title" class="field ArchetypesStringWidget">
                    <label for="title" class="formQuestion">
                        Titre du groupe d'exercices
                        <span id="title_wims_help" class="formHelp">
                            <tal:block i18n:translate="">Un titre de groupe, comme un titre d'exercice, est limité à 40 caractères.</tal:block><br />
                            <tal:block i18n:translate="">Attention : les caractères spéciaux</tal:block> (&lt; " &gt; { } ( ) $ &amp; …)
                            <tal:block i18n:translate="">sont interdits.</tal:block>
                        </span>
                    </label>
                    <div class="fieldErrorBox"></div>
                    <input type="text" maxlength="40"
                           id="title" name="title"
                           required="required" placeholder="Saisie obligatoire"
                           i18n:attributes="placeholder" />
                </div>

                <div id="archetypes-fieldname-qnum" class="field ArchetypesStringWidget">
                    <label for="qnum" class="formQuestion" i18n:translate="">
                        Nombre d'exercices de ce groupe auxquels l'étudiant devra répondre
                    </label>
                    <span class="formHelp">Une note ne sera attribuée qu'une fois la totalité des exercices terminés.</span>
                    <div class="fieldErrorBox"></div>
                    <select name="qnum" id="qnum">
                <tal:block repeat="val python:range(1,10)">
                        <option tal:attributes="value val" tal:content="val" />
                </tal:block>
                    </select>
                </div>

                <input type="hidden" name="authMember" tal:attributes="value user/getId" />
                <input type="hidden" name="modele" value="groupe" />
                <input type="hidden" name="macro" value="ajout-groupe-wims" />
                <input type="hidden" name="form.submitted" value="1" />

                <input type="hidden" name="create_wims_exercice_group_script:method" value="Save" />

                <div class="formControls">
                    <button type="submit" class="button small create radius"
                            name="create_wims_exercice_group_script:method">
                        <i class="fa fa-check-circle"></i>
                        <tal:block i18n:translate="">Créer le groupe</tal:block>
                    </button>
                </div>

            </form>
        </div>
    </metal:macro>

</metal:main>

</body>

</html>