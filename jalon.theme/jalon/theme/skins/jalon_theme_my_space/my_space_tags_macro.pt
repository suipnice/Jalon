
<!--
        Bloc de gestion des étiquettes
-->
<metal:macro define-macro="tags_section">
    <section class="small-12 columns">
        <div id="reveal-tags" class="reveal-modal small"
             data-reveal="data-reveal" data-options="close_on_background_click: true;"></div>
        <a data-reveal-id="reveal-tags" data-reveal-ajax="true"
           tal:attributes="href string:${context/absolute_url}/edit_tag_form"
           title="Éditer une étiquette" i18n:attributes="title"
            class="right">
            <i class="fa fa-pencil fa-lg"></i>
        </a>
        <a data-reveal-id="reveal-tags" data-reveal-ajax="true"
           tal:attributes="href string:${context/absolute_url}/create_tag_form"
           title="Créer une étiquette" i18n:attributes="title"
           class="right">
            <i class="fa fa-plus-circle fa-lg success"></i>
        </a>
        <h2 class="texte_icone icone_tags" i18n:translate="">Étiquettes</h2>
        <ul id="js-tag_filter"
            tal:define="tags_list my_view/tags_list">
            <metal:macro use-macro="context/my_space_tags_macro/macros/tags_list">
                Affichage de la liste des étiquettes
            </metal:macro>
        </ul>
    </section>
</metal:macro>


<!--
        Affichage de la liste des étiquettes
-->
<metal:macro define-macro="tags_list">
    <li tal:repeat="tag tags_list">
        <a tal:attributes="id tag/tag_id;
                           class tag/tag_css">
           <i class="fa fa-circle no-pad"></i>
           <i class="fa fa-circle-thin no-pad"></i>
           <tal:block tal:content="tag/tag_title" />
        </a>
    </li>
</metal:macro>


<!--
        Supprimer une étiquette
-->
<metal:macro define-macro="delete_tag">

    <tal:block condition="is_one_tag">

        <div class="panel callout radius">
            <tal:block i18n:translate="">Il n'y a aucune ressource avec l'étiquette</tal:block>
            « <strong tal:content="one_tag/tag_title" /> ».
        </div>

        <form id="js-delTag" method="POST"
              tal:attributes="action string:${context/absolute_url}/delete_tag_script;
                              data-tag_name string:${one_tag/tag_title};
                              data-success_msg_pre string:L'étiquette;
                              data-success_msg_post string:a été supprimée."
              i18n:attributes="data-success_msg_pre; data-success_msg_post">
            <input type="hidden" name="tag_id" tal:attributes="value one_tag/tag_id" />
            <button type="submit" class="button expand alert radius">
                <i class="fa fa-trash-o"></i>
                <tal:block i18n:translate="">Supprimer l'étiquette</tal:block>
                « <strong tal:content="python:context.getShortText(one_tag['tag_title'], 20)" /> »
            </button>
        </form>

        <tal:condition condition="is_ajax">
            <script charset="UTF-8"
                    tal:content="structure string:delTag()">
            </script>
        </tal:condition>

        <tal:condition condition="not:is_ajax">
            <tal:jsBuffer define="script string:delTag();
                                  addJsContent python:jsBuffer.addJS(script)" />
        </tal:condition>

    </tal:block>

    <tal:block condition="not:is_one_tag">
        <div class="panel callout radius"
             tal:condition="not:is_no_items"
             i18n:translate="">
            Il n'y a aucune ressource avec cette association d'étiquettes.
        </div>
    </tal:block>

</metal:macro>