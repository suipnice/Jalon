<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="jalon.content">

<body>

<metal:main fill-slot="content"
            tal:define="is_personnel python:context.isPersonnel(user);
                        email_registration_list context/getEmailRegistration">
    <h2>
        <tal:block i18n:translate="">Inscription(s) extérieure(s) par courriel</tal:block>
        <a class="close-reveal-modal"></a>
    </h2>

    <tal:isPersonnel condition="is_personnel">
    <h3>
        <button type="button" id="js-modeSwitcher" class="button tiny success radius">
            <i class="fa fa-code"></i>
            <tal:block i18n:translate="">Mode</tal:block>
        </button>
        <i class="fa fa-envelope-o no-pad"></i>
        <tal:block i18n:translate="">Inscrire par courriel des étudiant(e)s extérieur(e)s à l'établissement</tal:block>
    </h3>

    <form id="js-mailRegistrationList" class="no_reveal_action itemAdder"
          tal:condition="is_personnel">

        <fieldset class="row">

            <div class="panel callout radius">
                 <tal:block i18n:translate="">Pour constituer la liste des personnes à inscrire, renseignez les champs ci-dessous et cliquez sur « Ajouter ».</tal:block>
            </div>

            <!--legend i18n:translate="">Liste des étudiant(e)s extérieur(e)s à inscrire</legend-->
            <div class="medium-3 small-12 columns">
                <input name="lastname" class="medium-4 small-12 columns"
                       type="text" required="required"
                       pattern="^((?:[a-zA-Z]|[\s-'](?![\s-'])|[áàâäãåçéèêëíìîïñóòôöõúùûüýÿæœÁÀÂÄÃÅÇÉÈÊËÍÌÎÏÑÓÒÔÖÕÚÙÛÜÝŸÆŒ]){2,60})$"
                       placeholder="Nom"
                       i18n:attributes="placeholder" />
            </div>
            <div class="medium-3 small-12 columns">
                <input name="firstname" class="medium-4 small-12 columns"
                       type="text" required="required"
                       pattern="^((?:[a-zA-Z]|[\s-'](?![\s-'])|[áàâäãåçéèêëíìîïñóòôöõúùûüýÿæœÁÀÂÄÃÅÇÉÈÊËÍÌÎÏÑÓÒÔÖÕÚÙÛÜÝŸÆŒ]){2,60})$"
                       placeholder="Prénom"
                       i18n:attributes="placeholder" />
            </div>
            <div class="medium-4 small-12 columns">
                <input name="email" class="medium-4 small-12 columns"
                       type="text" required="required"
                       pattern="^(?![\.\-'_])(?:[a-zA-Z0-9]|[\.\-'_](?![\.\-'_]))+@[\w\.-]+\.[\w]{2,8}$"
                       placeholder="Adresse de courriel"
                       i18n:attributes="placeholder" />
            </div>
            <div class="medium-2 small-12 columns">
                <button type="submit" class="button tiny radius">
                    <i class="fa fa-plus-circle"></i>
                    <tal:block i18n:translate="">Ajouter</tal:block>
                </button>
            </div>

        </fieldset>

        <table>
            <tbody></tbody>
        </table>

        <div class="panel callout radius hide">
             <tal:block i18n:translate="">Vous pouvez retirer des élément de la liste en cliquant sur</tal:block>
             « <i class="fa fa-minus-circle no-pad warning"></i> ».
        </div>

    </form>

    <form id="js-mailRegistration" class="no_reveal_action itemAdder" method="POST"
          tal:attributes="action string:${context/absolute_url}/add_course_email_registration_script">

        <fieldset class="row hide">

            <div tal:define="error errors/invitation | nothing;
                             arch_class string:field;"
                 tal:attributes="class python:context.test(error, 'error %s' % arch_class, arch_class)">
                <label for="mailUserList">Liste des étudiant(e)s extérieur(e)s à inscrire</label>
                <!--div class="fieldErrorBox"
                     tal:condition="error"
                     tal:content="error" /-->
                <div class="fieldErrorBox"
                     tal:content="error" />
                <input type="text" id="mailUserList" name="invitation"
                       placeholder="Prénom Nom &lt;compte@domaine.tld&gt;"
                       tal:attributes="value request/invitation | nothing"
                       i18n:attributes="placeholder" />
            </div>

            <div class="panel warning radius">
                <strong><tal:block i18n:translate="">Très important :</tal:block></strong><br />
                Utilisez la syntaxe suivante pour inscrire vos étudiants via le champ ci-dessus :
                <pre>Prénom Nom &lt;compte@domaine.tld&gt;</pre>
                Vous pouvez en inscrire plusieurs simultanément en les séparant par une virgule :
                <pre>Prénom1 Nom1 &lt;compte1@domaine1.tld&gt;, Prénom2 Nom2 &lt;compte2@domaine2.tld&gt;, etc.</pre>
            </div>

        </fieldset>

        <div class="formControls">
            <button type="submit" class="button small expand radius">
                <i class="fa fa-check-circle"></i>
                <tal:block i18n:translate="">Inscrire ces étudiants au cours</tal:block>
            </button>
        </div>

    </form>

    <script charset="UTF-8"
            tal:content="structure string:setMailRegistrationForm()"></script>
    </tal:isPersonnel>

    <metal:macro define-macro="display_email_registration">
    <div class="panel callout radius"
         tal:condition="not:email_registration_list">
         <tal:block i18n:translate="">Aucun(e) étudiant(e) extérieur(e) n'a pour l'instant été inscrit(e) par courriel à ce cours.</tal:block>
    </div>

    <div id="js-courriel-insc_list"
         tal:condition="email_registration_list">

        <h3 class="texte_icone icone_users"
            i18n:translate="">Étudiant(e)s extérieur(e)s inscrit(e)s par courriel</h3>

        <table class="listing">
        <thead>
            <tr>
                <th class="sort" data-sort="name" title="Trier selon le nom" i18n:attributes="title">
                    <span>
                        <i class="fa fa-sort"></i>
                        <i class="fa fa-sort-asc"></i>
                        <i class="fa fa-sort-desc"></i>
                        <tal:block i18n:translate="">Nom complet</tal:block>
                    </span>
                </th>
                <th class="sort" data-sort="email" title="Trier selon l'adresse de courriel" i18n:attributes="title">
                    <span>
                        <i class="fa fa-sort"></i>
                        <i class="fa fa-sort-asc"></i>
                        <i class="fa fa-sort-desc"></i>
                        <tal:block i18n:translate="">Courriel</tal:block>
                    </span>
                </th>
            </tr>
        </thead>
        <tbody class="list">
            <tr tal:repeat="email_registration email_registration_list">
                <td class="name" tal:content="email_registration/nom" />
                <td class="email" tal:content="email_registration/email" />
            </tr>
        </tbody>
        </table>

        <script charset="UTF-8"
                tal:content="structure string:setSortableList('js-courriel-insc_list',['name','email'],'name','asc')"></script>

    </div>
    </metal:macro>

</metal:main>

</body>

</html>