<metal:macro define-macro="add_course_items">
    <tal:no_items condition="my_view/is_no_items">
        <div class="panel callout radius">
            <strong i18n:translate="">Il n'y a aucun Exercice WIMS dans votre espace.</strong><br />
            <tal:block i18n:translate="">Pour créer un Exercice WIMS rendez-vous dans "Mes ressources > Exercices WIMS".</tal:block>
        </div>
        <div class="text-center">
            <a class="button radius"
               tal:attributes="href my_view/folder_link">
                <i tal:attributes="class my_view/course_add_list_icon"></i><tal:replace replace="context/Title" i18n:translate=""/>
            </a>
        </div>
    </tal:no_items>

    <tal:block condition="not:my_view/is_no_items">
        <div class="panel callout radius"
             tal:condition="not:my_view/course_add_list"
             i18n:translate="">
            Il n'y a aucune ressource avec cette association d'étiquettes.
        </div>
    </tal:block>

    <tal:listing condition="my_view/course_add_list">
    <input type="hidden" name="tab" value="exercices"/>
    <div class="el_counter">
        <tal:block replace="my_view/nb_display_items" />
        <tal:block i18n:translate="">sur</tal:block>
        <tal:block replace="my_view/nb_items" />
    </div>

    <script charset="UTF-8"
            tal:content="structure string:var NB_LISTED_ELEMENTS = ${my_view/nb_display_items}"></script>

    <table summary="Liste des fichiers">
    <thead>
        <tr>
            <th class="checkall show-for-medium-up">
                <div class="switch tiny round" title="Action par lot : tout sélectionner / désélectionner"
                     i18n:attributes="title">
                    <input type="checkbox" id="switch-all" name="checkall" role="paths:list" />
                    <label for="switch-all"></label>
                </div>
            </th>
            <th class="sort show-for-medium-up" data-sort="date" title="Trier selon la date"
                i18n:attributes="title">
                <span>
                    <i class="fa fa-sort"></i>
                    <i class="fa fa-sort-asc"></i>
                    <i class="fa fa-sort-desc"></i>
                    <tal:block i18n:translate="">Date</tal:block>
                </span>
            </th>
            <th class="sort has-tip" data-tooltip data-sort="model" title="Trier selon le modèle"
                i18n:attributes="title">
                <span>
                    <i class="fa fa-sort"></i>
                    <i class="fa fa-sort-asc"></i>
                    <i class="fa fa-sort-desc"></i>
                    <tal:block i18n:translate="">Modèle</tal:block>
                </span>
            </th>
            <th class="sort text-left" data-sort="title" title="Trier selon le titre"
                i18n:attributes="title">
                <span>
                    <i class="fa fa-sort"></i>
                    <i class="fa fa-sort-asc"></i>
                    <i class="fa fa-sort-desc"></i>
                    <tal:block i18n:translate="">Titre / Description</tal:block>
                </span>
            </th>
        </tr>
    </thead>
    <tbody class="list"
           tal:define="user_id user/getId;
                       wims_exercice_model_list my_view/wims_exercice_model_list">
        <tr tal:repeat="item my_view/course_add_list">
            <tal:define define="item_title python:here.getShortText(item['Title'])">
            <td class="show-for-medium-up"
                tal:define="attached python:context.test(item['getId'].replace('.', '*-*') in my_view['course_map'], 1, 0)">
                <div class="switch tiny round" title="Action par lot : sélectionner / désélectionner"
                     tal:condition="not:attached"
                     i18n:attributes="title">
                    <input type="checkbox" name="paths:list"
                           tal:attributes="id string:switch-${repeat/item/index};
                                           value string:${item/getId}/${item/Type};
                                           data-res_name item_title"/>
                    <label tal:attributes="for string:switch-${repeat/item/index}"></label>
                </div>
                <i class="fa fa-check fa-lg success" tal:condition="attached"></i>
            </td>
            <td class="date show-for-medium-up">
                <span class="hide" tal:content="python:context.getLocaleDate(item['ModificationDate'], '%Y%m%d%H%M%S')"/>
                <span tal:content="python:context.getLocaleDate(item['ModificationDate'])"/>
            </td>
            <td class="model"
                tal:define="exo_model item/getModele">
                <span class="label bkgrnd"
                      tal:define="model python:wims_exercice_model_list[exo_model]"
                      tal:content="model | string:modele inconnu"
                      i18n:translate="" />
            </td>
            <td class="title">
                <span class="hide" tal:content="item/Title" />
                <strong tal:content="item_title"
                        i18n:attributes="title"/>
                <span class="show-for-medium-up"
                      tal:condition="item/Description"
                      tal:content="python:here.getShortText(item['Description'], 200)"/>
            </td>
            </tal:define>
        </tr>
    </tbody>
    </table>

    <tal:define define="script1 string:setBatchSelect('js-attachmentCreator');
                        script2 string:setSortableList('js-list-ressource',['date','filetype','title'],'date','desc')">
        <tal:jsBuffer define="addDirectJsContent python:jsBuffer.addJSDirect(script1)" />
        <tal:jsBuffer define="addDirectJsContent python:jsBuffer.addJSDirect(script2)" />
    </tal:define>

    <script charset="UTF-8"
            tal:define="buffer python:jsBuffer.getDirectBuffer()"
            tal:content="structure buffer"></script>
    </tal:listing>

</metal:macro>

<metal:macro define-macro="add_new_resource">
    <div class="panel callout radius">
        <tal:block i18n:translate="">Pour créer un Exercice WIMS rendez-vous dans "Mes ressources > Exercices WIMS".</tal:block>
    </div>
    <div class="text-center">
        <a class="button radius"
           tal:attributes="href my_view/folder_link">
           <i tal:attributes="class my_view/course_add_list_icon"></i><tal:replace replace="context/Title" i18n:translate=""/>
        </a>
    </div>
</metal:macro>