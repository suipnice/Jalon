<metal:macro define-macro="course_map_item_adder">

<div class="panel bkgrnd radius show-for-medium-up">
<h3 class="show-for-medium-up">
    <i class="fa fa-plus-circle"></i>
    <tal:block i18n:translate="">Ajouter des éléments</tal:block>
</h3>
<nav id="item-adder">
    <ul class="button-group radius">
        <li tal:repeat="item_adder my_view/course_map_item_adder">
            <a tal:attributes="class item_adder/menu_adder_class;
                               data-dropdown item_adder/menu_adder_data-dropdown"
                               data-options="align:bottom">
                <i tal:attributes="class item_adder/menu_adder_icon"></i>
                <tal:replace replace="item_adder/menu_adder_name" i18n:translate=""/>
            </a>
            <ul tal:attributes="id item_adder/menu_adder_data-dropdown" 
                class="f-dropdown" data-dropdown-content>
                <li tal:repeat="menu_adder_item item_adder/menu_adder_items">
                    <a tal:attributes="href menu_adder_item/item_link"
                       data-reveal-id="reveal-main" data-reveal-ajax="true">
                        <i tal:attributes="class menu_adder_item/item_icon"></i>
                        <tal:replace replace="menu_adder_item/item_name" i18n:translate=""/>
                    </a>
                </li>
            </ul>
        </li>
    </ul>
</nav>
</div>

</metal:macro>


<metal:macro define-macro="course_map_form">

    <div class="field">
        <label for="position">Positionner dans le plan</label>
        <select id="position" name="position">
            <option value="debut_racine">
                Au début du plan
            </option>
            <option value="fin_racine" selected="selected">
                À la fin du plan
            </option>
            <optgroup label="Dans :"
                      tal:define="course_map python:context.getPlan();
                                  parent_id string:racine;
                                  position python:0">
                <metal:macro define-macro="course_map_select">
                <tal:repeat repeat="element course_map">
                    <tal:define define="position python:position + 1">
                    <tal:condition condition="python:element['idElement'].startswith('Titre')">
                    <option tal:attributes="value string:${parent_id}*-*${element/idElement}">
                        <tal:repeat repeat="tmp python:range(position - 1)">
                            &nbsp;&nbsp;
                        </tal:repeat>
                        <tal:replace replace="python:context.getShortText(context.supprimerMarquageHTML(context.getElementCours(element['idElement'])['titreElement']))"/>
                        <tal:define define="elements_titre element/listeElement;
                                            parent_id string:${parent_id}*-*${element/idElement}">
                            <metal:macro use-macro="context/course_map_macro/macros/course_map_select"/>
                        </tal:define>
                    </option>
                    </tal:condition>
                    </tal:define>
                </tal:repeat>
                </metal:macro>
            </optgroup>
        </select>
    </div>

</metal:macro>