<metal:macro define-macro="course_map_item_adder">

<div class="panel bkgrnd radius show-for-medium-up">
    <h3 class="show-for-medium-up">
        <i class="fa fa-plus-circle"></i>
        <tal:block i18n:translate="">Ajouter des éléments</tal:block>
    </h3>
    <nav id="item-adder">
        <ul class="button-group even-3 radius">
            <li tal:repeat="item_adder my_view/course_map_item_adder">
                <a tal:attributes="class item_adder/menu_adder_class;
                                   data-dropdown item_adder/menu_adder_data-dropdown"
                                   data-options="align:bottom">
                    <i tal:attributes="class item_adder/menu_adder_icon"></i>
                    <tal:replace replace="item_adder/menu_adder_name" i18n:translate=""/>
                </a>
                <ul tal:attributes="id item_adder/menu_adder_data-dropdown"
                    class="f-dropdown" data-dropdown-content>
                    <li tal:repeat="menu_adder_item item_adder/menu_adder_items">
                        <a tal:attributes="href menu_adder_item/item_link"
                           data-reveal-id="reveal-main" data-reveal-ajax="true">
                            <i tal:attributes="class menu_adder_item/item_icon"></i>
                            <tal:replace replace="menu_adder_item/item_name" i18n:translate=""/>
                        </a>
                    </li>
                </ul>
            </li>
        </ul>
    </nav>
</div>

</metal:macro>


<metal:macro define-macro="display_course_map">
        <li class="legend element"
            tal:condition="my_view/is_personnel">
            <i class="fa fa-info-circle fa-fw"></i>
            Faites glisser des éléments existants du plan sur le titre, ou ajoutez de nouveaux éléments.
        </li>
    <tal:repeat repeat="element course_map/course_map_items_list">
        <li tal:attributes="id element/item_css_id;
                            class element/item_css_class">
            <div tal:attributes="class element/item_div_css">
                <tal:condition condition="my_view/is_personnel">
                <a class="dropdown" data-options="align:left"
                   tal:attributes="data-dropdown string:${element/item_drop_id}">
                    <i class="fa fa-cog fa-fw no-pad"></i>
                </a>
                <ul class="f-dropdown" data-dropdown-content="data-dropdown-content"
                    tal:attributes="id string:${element/item_drop_id}">
                    <li tal:repeat="item_action element/item_actions">
                        <a data-reveal-ajax="true" data-reveal-id="reveal-main"
                           tal:attributes="href string:${course_link}/${item_action/item_action_id}?item_id=${element/item_id}">
                            <i tal:attributes="class item_action/item_action_icon"></i>
                            <tal:replace tal:replace="item_action/item_action_name" i18n:translate=""/>
                        </a>
                    </li>
                </ul>
                </tal:condition>
                <i class='fa fa-bell-o fa-fw fa-lg no-pad right'
                   tal:condition="element/is_item_new"></i>

                <a class="right"
                   tal:attributes="href element/item_read_link"
                   tal:condition="element/is_item_readable">
                    <i tal:attributes="class element/item_read_icon"></i>
                </a>

                <i tal:attributes="class element/is_display_item_icon;
                                   title element/is_display_item_text"
                   tal:condition="not:element/is_display_item_bool"></i>

                <i class="fa fa-hand-o-left fa-lg fa-fw no-pad jalonner right" data-tooltip
                   tal:attributes="title element/item_jalonner_comment"
                   tal:condition="element/is_item_jalonner"></i>

                <span tal:attributes="class element/item_span_css">
                    <i title="Cliquer pour replier/déplier le contenu." class="fa no-pad js-fold"
                       tal:condition="element/is_item_title"></i>
                    <a tal:attributes="href element/item_link | nothing;
                                       class string:typeElementTitre"
                       title="Voir cet élément du plan"
                       data-reveal-id="reveal-main" data-reveal-ajax="true"
                       tal:content="structure element/item_title"
                       tal:omit-tag="element/is_item_title_or_text"
                       i18n:attributes="title"/>
                </span>
            </div>
            <tal:condition condition="element/is_item_title">
            <tal:define define="course_map python:context.getCourseMapItems(element['course_map_sub_items_list'], user.getId(), my_view['user_last_login_time'], my_view['is_personnel'], my_view['course_news']['listeActu'], my_view['item_jalonner'], my_view['portal']);">
            <ol>
            <metal:macro use-macro="context/course_map_macro/macros/display_course_map">
                Affichage du plan du cours
            </metal:macro>
            </ol>
            </tal:define>
            </tal:condition>
        </li>
    </tal:repeat>
</metal:macro>